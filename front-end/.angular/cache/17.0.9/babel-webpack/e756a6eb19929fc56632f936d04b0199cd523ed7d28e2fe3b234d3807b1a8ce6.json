{"ast":null,"code":"import _asyncToGenerator from \"/home/miguel/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component, ViewChild } from '@angular/core';\nimport { Chart, registerables } from 'chart.js';\nimport { singular } from 'pluralize';\nChart.register(...registerables);\nlet StatisticsComponent = class StatisticsComponent {\n  constructor(apiService, stadisticsService, http, spinnerService) {\n    this.apiService = apiService;\n    this.stadisticsService = stadisticsService;\n    this.http = http;\n    this.spinnerService = spinnerService;\n    this.selectedYears = [];\n    this.PapersAndArticles = [];\n    this.collaborations = [];\n    this.singleAuthor = [];\n    this.statistics = [];\n    this.statsAuthors = [];\n    this.statsPaperAndArticle = [];\n    this.ConferencesAndJournalCount = 0;\n    this.ConferencesAndJournalAuthors = 0;\n    this.totalAuthorsByYear = [];\n    this.PapersAndArticlesByYear = [];\n    this.totalArticlesByYear = [];\n    this.totalPapersByYear = [];\n    this.singlePapersAndArticle = [];\n    this.decadeStats = [];\n    this.researchers = [];\n    this.papersAndarticlesWithAuthors = [];\n    this.loadingTable1 = true;\n    this.loadingTable2 = true;\n    this.commonNames = {};\n    this.options = {\n      width: 500,\n      height: 200,\n      overflow: false,\n      realignOnResize: false,\n      strict: false,\n      step: 2\n    };\n    this.cloudData = [];\n  }\n  ngOnInit() {\n    this.loadCommonNames();\n    this.main();\n  }\n  // API CALL: Function to search for authors of conferences and journals\n  getResearchersConferenceAndJournals() {\n    this.apiService.getResearchersConferenceAndJournals(this.stadisticsService.selectedTitles, this.stadisticsService.ConferenceOrJournalName).subscribe({\n      next: response => {\n        this.researchers = [];\n        this.researchers = response;\n        this.statsResearchers();\n        this.statsTotalAuthorsByYear();\n        if (this.researchers.length > 1) {\n          this.generateChartPapersAndArticles('lineChart1', this.statsAuthors);\n          this.generateTotalAuthorsChart('lineChart6', 'Total Authors by Year', this.totalAuthorsByYear);\n        }\n      },\n      error: error => {\n        console.error('Error in getResearchersConference:', error);\n      }\n    });\n  }\n  // API CALL: Function to search for papers and articles of conferences and journals\n  getPapersAndArticles() {\n    this.apiService.getPapersAndArticles(this.stadisticsService.selectedTitles, this.stadisticsService.ConferenceOrJournalName).subscribe({\n      next: response => {\n        this.PapersAndArticles = response;\n        if (this.PapersAndArticles.length > 0) {\n          this.statsPapersAndArticles();\n          this.statsTotalPapersAndArticlesByYear();\n        }\n      },\n      error: error => {\n        console.error('Error in getPapers:', error);\n      }\n    });\n  }\n  // API CALL: Function to find collaborations of journals and conferences\n  getCollaborations() {\n    this.apiService.getCollaborations(this.stadisticsService.selectedTitles, this.stadisticsService.ConferenceOrJournalName).subscribe({\n      next: response => {\n        this.collaborations = response;\n        this.statsColaboraciones();\n        this.generateChartDensity('lineChart3', 'Density', this.statistics[3].years, this.statistics[3].densidades);\n      },\n      error: error => {\n        console.error('Error in getCollaborations:', error);\n      }\n    });\n  }\n  // API CALL: Function to find the conference by proceeding\n  getConferencebyProceeding() {\n    this.apiService.getConferencebyProceeding(this.stadisticsService.selectedTitles, this.stadisticsService.ConferenceOrJournalName).subscribe({\n      next: response => {\n        this.stadisticsService.ConferenceOrJournalNames = [];\n        this.stadisticsService.years = [];\n        this.stadisticsService.inprocedings = [];\n        response.forEach(({\n          title,\n          year,\n          numberOfInProceedings\n        }) => {\n          this.stadisticsService.ConferenceOrJournalNames.push(title);\n          this.stadisticsService.years.push(year);\n          this.stadisticsService.inprocedings.push(numberOfInProceedings);\n        });\n        this.loadingTable1 = false;\n        this.generateTablesProceeding(this.stadisticsService.ConferenceOrJournalNames, this.stadisticsService.years, this.stadisticsService.inprocedings);\n      },\n      error: error => {\n        console.error('Error in getConferencebyProceeding:', error);\n      }\n    });\n  }\n  // API CALL: Function to find the authors of papers and articles\n  getAuthorsPapersAndArticles() {\n    var _this = this;\n    this.apiService.getAuthorsPapersAndArticles(this.stadisticsService.selectedTitles, this.stadisticsService.ConferenceOrJournalName).subscribe({\n      next: function () {\n        var _ref = _asyncToGenerator(function* (response) {\n          _this.singleAuthor = response;\n          _this.statsSingleAuthor();\n        });\n        return function next(_x) {\n          return _ref.apply(this, arguments);\n        };\n      }(),\n      error: error => {\n        console.error('Error in getAuthorsPapers:', error);\n      }\n    });\n  }\n  // Function to save the total number of authors per year\n  statsTotalAuthorsByYear() {\n    const years = this.stadisticsService.selectedTitles;\n    years.sort((a, b) => parseInt(a) - parseInt(b));\n    this.totalAuthorsByYear = years.map(year => {\n      const totalAuthors = this.researchers.reduce((total, researcher) => {\n        if (researcher.years.includes(year)) {\n          return total + 1;\n        }\n        return total;\n      }, 0);\n      return {\n        year: year,\n        totalAuthors: totalAuthors\n      };\n    });\n  }\n  // Function to save the total number of papers and articles per year\n  statsTotalPapersAndArticlesByYear() {\n    let years = this.PapersAndArticles.map(item => item.year);\n    years = years.filter((value, index, self) => self.indexOf(value) === index);\n    years.sort((a, b) => parseInt(a) - parseInt(b));\n    const papersByYear = this.PapersAndArticles.filter(item => item.type === \"Paper\");\n    const articlesByYear = this.PapersAndArticles.filter(item => item.type === \"Article\");\n    this.PapersAndArticlesByYear = years.map(year => {\n      const papersOfYear = papersByYear.filter(paper => paper.year === year);\n      const articlesOfYear = articlesByYear.filter(article => article.year === year);\n      const totalPapers = papersOfYear.reduce((total, paper) => {\n        return total + paper.numPapersAndArticles.low;\n      }, 0);\n      const totalArticles = articlesOfYear.reduce((total, article) => {\n        return total + article.numPapersAndArticles.low;\n      }, 0);\n      return {\n        year: year,\n        totalPapers: totalPapers,\n        totalArticles: totalArticles\n      };\n    });\n    this.generateTotalAuthorsChart('lineChart7', 'Total Papers and Articles by Year', this.PapersAndArticlesByYear);\n  }\n  // Function to generate the table of conferences, including specific exceptions\n  generateTablesProceeding(venueTitles, years, numberOfInProceedings) {\n    const table = document.querySelector('#tableProceeding tbody');\n    if (table instanceof HTMLElement) {\n      table.innerHTML = '';\n      venueTitles.forEach((venueTitle, index) => {\n        const parts = venueTitle.split(',');\n        if (parts.length == 6) {\n          parts[4] = parts[4].replace(\"Proceedings\", \"\");\n          const date = parts[4].split('.');\n          const rowData = {\n            name: parts[0] + '-' + parts[1].trim(),\n            location: parts[2] + ',' + parts[3],\n            date: date.slice(0).join(' ')\n          };\n          const row = document.createElement('tr');\n          row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n          table.appendChild(row);\n        }\n        if (parts.length == 5) {\n          parts[3] = parts[3].replace(\"Proceedings\", \"\").trim();\n          const date = parts[3].split('.');\n          const hasNumber = /\\d/.test(date[0]);\n          if (hasNumber) {\n            if (parts[1].includes(\"Florence\")) {\n              const rowData = {\n                name: parts[0],\n                location: parts[1].trim() + ',' + parts[2],\n                date: date[0]\n              };\n              const row = document.createElement('tr');\n              row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n              table.appendChild(row);\n            } else {\n              const rowData = {\n                name: parts[0] + '-' + parts[1].trim(),\n                location: parts[2],\n                date: date[0]\n              };\n              const row = document.createElement('tr');\n              row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n              table.appendChild(row);\n            }\n          } else {\n            const rowData = {\n              name: parts[0] + '-' + parts[1].trim(),\n              location: parts[2] + ', ' + parts[3],\n              date: parts[4]\n            };\n            const row = document.createElement('tr');\n            row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n            table.appendChild(row);\n          }\n        }\n        if (parts.length == 7) {\n          parts[5] = parts[5].replace(\"Proceedings\", \"\");\n          const date = parts[5].split('.');\n          if (parts[2].length > 15) {\n            const rowData = {\n              name: parts[0] + '-' + parts[1].trim(),\n              location: parts[3] + ', ' + parts[4],\n              date: date[0]\n            };\n            const row = document.createElement('tr');\n            row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n            table.appendChild(row);\n          } else {\n            const isValidFormat = /^[a-zA-Z]+\\s+\\d{1,2}(-\\d{1,2}|\\d{1,2}[a-zA-Z]+\\s+\\d{1,2})$/.test(date[0].trim());\n            if (isValidFormat) {\n              if (parts[2].includes(\"ER\")) {\n                const rowData = {\n                  name: parts[0] + ',' + parts[1].trim() + '-' + parts[2],\n                  location: parts[3] + ', ' + parts[4],\n                  date: date[0]\n                };\n                const row = document.createElement('tr');\n                row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n                table.appendChild(row);\n              } else {\n                const rowData = {\n                  name: parts[0] + '-' + parts[1].trim(),\n                  location: parts[2] + ', ' + parts[3] + ', ' + parts[4],\n                  date: date[0]\n                };\n                const row = document.createElement('tr');\n                row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n                table.appendChild(row);\n              }\n            } else {\n              const rowData = {\n                name: parts[0] + '-' + parts[1].trim(),\n                location: parts[2] + ', ' + parts[3],\n                date: parts[4] + ', ' + date[0]\n              };\n              const row = document.createElement('tr');\n              row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n              table.appendChild(row);\n            }\n          }\n        }\n      });\n    }\n  }\n  // Function to obtain the distributions of both authors by papers and papers by authors\n  getDistributions() {\n    const labels = ['1', '2', '3', '4', '5 o más'];\n    const authorsByPaper = [1, 2, 3, 4].map(numAuthors => this.papersAndarticlesWithAuthors.filter(item => item.numAuthors === numAuthors).length);\n    authorsByPaper[4] = this.papersAndarticlesWithAuthors.filter(item => item.numAuthors >= 5).length;\n    let allPapers = this.PapersAndArticles.reduce((all, item) => all + item.numPapersAndArticles.low, 0);\n    const papersByAuthor = [1, 2, 3, 4].map(numPubs => this.singleAuthor.filter(paper => paper.numPublications === numPubs).length);\n    papersByAuthor[4] = this.singleAuthor.filter(paper => paper.numPublications >= 5).length;\n    const allAuthors = this.singleAuthor.length;\n    const authorsTable = document.querySelector('#authorsTable tbody');\n    const papersTable = document.querySelector('#papersTable tbody');\n    if (authorsTable !== null) {\n      authorsByPaper.forEach((amount, index) => {\n        const row = document.createElement('tr');\n        const percentage = (amount / allPapers * 100).toFixed(2);\n        const worth = amount.toString() + \"(\" + percentage + \")\";\n        row.innerHTML = `<td>${labels[index]}</td><td>${worth}</td>`;\n        authorsTable.appendChild(row);\n      });\n    }\n    if (papersTable !== null) {\n      papersByAuthor.forEach((amount, index) => {\n        const row = document.createElement('tr');\n        const percentage = (amount / allAuthors * 100).toFixed(2);\n        const worth = amount.toString() + \"(\" + percentage + \")\";\n        row.innerHTML = `<td>${labels[index]}</td><td>${worth}</td>`;\n        papersTable.appendChild(row);\n      });\n    }\n  }\n  // Function to save demographic data\n  getDemographicData() {\n    const datasets = this.researchers.map(researcher => {\n      let name = researcher.researcher.properties.name.split(' ')[0];\n      if (name.includes(\"-\")) {\n        name = name.split('-')[0];\n      }\n      const years = Array.isArray(researcher.years) ? researcher.years : [researcher.years];\n      const datasetByYear = years.map(year => {\n        const info = this.commonNames[name];\n        const genero = info ? info.genero : 'Unknown';\n        const frecuencias = info ? info.frec_paises : {};\n        return {\n          year,\n          name,\n          genero,\n          frecuencias\n        };\n      });\n      return datasetByYear;\n    }).flat();\n    this.statsGender(datasets);\n    this.statsGeography(datasets);\n  }\n  // Function to generate n-grams\n  generateNGrams(titles, n) {\n    const ngrams = [];\n    titles.forEach(title => {\n      const words = title.toLowerCase().split(\" \");\n      for (let i = 0; i < words.length - n + 1; i++) {\n        ngrams.push(words.slice(i, i + n).join(\" \"));\n      }\n    });\n    return ngrams;\n  }\n  // Function to count frequencies\n  countFrequencies(ngrams) {\n    const frequencies = new Map();\n    ngrams.forEach(ngram => {\n      const count = frequencies.get(ngram) || 0;\n      frequencies.set(ngram, count + 1);\n    });\n    return frequencies;\n  }\n  // Function to clean the title\n  clearTitle(title, stopwords) {\n    const words = title.toLowerCase().split(\" \").map(word => word.replace(/[^\\w\\s]/g, \"\"));\n    const wordsNoRepeat = words.map(word => word.replace(/(.)\\1+/g, \"$1\"));\n    const singularWords = wordsNoRepeat.map(word => singular(word));\n    const filteredWords = singularWords.filter(word => !stopwords.includes(word));\n    const newTitle = filteredWords.join(' ');\n    return newTitle;\n  }\n  // Function that returns an array with the highest frequencies\n  getTopN(frequencies, n) {\n    const sortedFrequencies = [...frequencies.entries()].sort((a, b) => b[1] - a[1]);\n    return sortedFrequencies.slice(0, n);\n  }\n  // Function to generate the table of bigrams and trigrams\n  getTopicAnalysis() {\n    const stopwords = ['i', 'me', 'my', 'myself', 'we', 'our', 'ours', 'ourselves', 'you', 'your', 'yours', 'yourself', 'yourselves', 'he', 'him', 'his', 'himself', 'she', 'her', 'hers', 'herself', 'it', 'its', 'itself', 'they', 'them', 'their', 'theirs', 'themselves', 'what', 'which', 'who', 'whom', 'this', 'that', 'these', 'those', 'am', 'is', 'are', 'was', 'were', 'be', 'been', 'being', 'have', 'has', 'had', 'having', 'do', 'does', 'did', 'doing', 'a', 'an', 'the', 'and', 'but', 'if', 'or', 'because', 'as', 'until', 'while', 'of', 'at', 'by', 'for', 'with', 'about', 'against', 'between', 'into', 'through', 'during', 'before', 'after', 'above', 'below', 'to', 'from', 'up', 'down', 'in', 'out', 'on', 'off', 'over', 'under', 'again', 'further', 'then', 'once', 'here', 'there', 'when', 'where', 'why', 'how', 'all', 'any', 'both', 'each', 'few', 'more', 'most', 'other', 'some', 'such', 'no', 'nor', 'not', 'only', 'own', 'same', 'so', 'than', 'too', 'very', 's', 't', 'can', 'will', 'just', 'don', 'should', 'now', '.', ','];\n    const cleanTitles = this.papersAndarticlesWithAuthors.map(item => {\n      const ipName = this.clearTitle(item.ipName, stopwords);\n      const year = parseInt(item.year);\n      return {\n        ipName,\n        year\n      };\n    });\n    const bigrams = this.generateNGrams(cleanTitles.map(item => item.ipName), 2);\n    const trigrams = this.generateNGrams(cleanTitles.map(item => item.ipName), 3);\n    const bigramFrequencies = this.countFrequencies(bigrams);\n    const trigramFrequencies = this.countFrequencies(trigrams);\n    const top20Bigrams = this.getTopN(bigramFrequencies, 20);\n    const top20Trigrams = this.getTopN(trigramFrequencies, 20);\n    const top20BigramsWithYears = top20Bigrams.map(([ngram, count]) => ({\n      ngram,\n      count,\n      years: cleanTitles.filter(paper => paper.ipName.includes(ngram)).map(paper => paper.year)\n    }));\n    const top20TrigramsWithYears = top20Trigrams.map(([ngram, count]) => ({\n      ngram,\n      count,\n      years: cleanTitles.filter(paper => paper.ipName.includes(ngram)).map(paper => paper.year)\n    }));\n    const table1 = document.querySelector('#tableBigramas tbody');\n    const table2 = document.querySelector('#tableTrigramas tbody');\n    if (table1 instanceof HTMLElement && table2 instanceof HTMLElement) {\n      top20BigramsWithYears.forEach(({\n        ngram,\n        count,\n        years\n      }) => {\n        const minYear = Math.min(...years);\n        const maxYear = Math.max(...years);\n        const row = document.createElement('tr');\n        row.innerHTML = `<td>${ngram}</td><td>${count}</td><td>${minYear}</td><td>${maxYear}</td>`;\n        table1.appendChild(row);\n      });\n      top20TrigramsWithYears.forEach(({\n        ngram,\n        count,\n        years\n      }) => {\n        const minYear = Math.min(...years);\n        const maxYear = Math.max(...years);\n        const row = document.createElement('tr');\n        row.innerHTML = `<td>${ngram}</td><td>${count}</td><td>${minYear}</td><td>${maxYear}</td>`;\n        table2.appendChild(row);\n      });\n    }\n    const combinedData = [...top20BigramsWithYears, ...top20TrigramsWithYears];\n    combinedData.sort((a, b) => b.count - a.count);\n    const maxFrecuencia = combinedData[0].count;\n    const minWeight = 0;\n    const maxWeight = 20;\n    const wordCloudData = combinedData.map((item, index) => ({\n      text: item.ngram,\n      weight: this.calculateWeight(item.count, maxFrecuencia, minWeight, maxWeight),\n      color: this.getRandomColor(index)\n    }));\n    this.cloudData = wordCloudData;\n  }\n  // Function to calculate the weight\n  calculateWeight(frec, maxFrec, minWeight, maxWeight) {\n    const weight = frec / maxFrec;\n    const normWeight = weight * (maxWeight - minWeight) + minWeight;\n    return Math.round(normWeight);\n  }\n  // Function to save author statistics\n  statsResearchers() {\n    const names = new Set(this.researchers.map(researcher => researcher.name));\n    this.ConferencesAndJournalAuthors = names.size;\n    this.statsAuthors = [];\n    this.statsAuthors = Array.from(names).map(name => {\n      const years = this.stadisticsService.selectedTitles;\n      years.sort((a, b) => parseInt(a) - parseInt(b));\n      this.selectedYears = years;\n      const numResearchersPorAnio = years.map(anio => this.researchers.reduce((total, researcher) => {\n        if (researcher.name === name && researcher.years.includes(anio)) {\n          return total + 1;\n        }\n        return total;\n      }, 0));\n      return {\n        name: name,\n        years: years,\n        numResearchers: numResearchersPorAnio\n      };\n    });\n  }\n  // Function to save author statistics\n  statsPapersAndArticles() {\n    const names = new Set(this.PapersAndArticles.map(item => item.name));\n    this.ConferencesAndJournalCount = names.size;\n    this.statsPaperAndArticle = Array.from(names).map(name => {\n      let years = this.PapersAndArticles.map(item => item.year);\n      years = years.filter((value, index, self) => self.indexOf(value) === index);\n      years.sort((a, b) => parseInt(a) - parseInt(b));\n      const numPapersAndArticlesPorAnio = years.map(year => this.PapersAndArticles.reduce((total, item) => {\n        const numPapersAndArticles = item.numPapersAndArticles.low;\n        if (item.name === name && item.year === year) {\n          return total + numPapersAndArticles;\n        }\n        return total;\n      }, 0));\n      return {\n        name: name,\n        years: years,\n        numResearchers: numPapersAndArticlesPorAnio\n      };\n    });\n    this.generateChartPapersAndArticles('lineChart2', this.statsPaperAndArticle);\n  }\n  // Function to generate and save collaboration statistics\n  statsColaboraciones() {\n    let colabsXtotal = [];\n    const colabsPapers = this.PapersAndArticles.map(item => {\n      const colab = this.collaborations.find(c => c.year === item.year);\n      const integer = item.numPapersAndArticles.low;\n      return {\n        year: item.year,\n        numColabs: colab ? colab.numColabs : 0,\n        numPapersAndArticles: integer\n      };\n    });\n    colabsXtotal = colabsXtotal.concat(colabsPapers);\n    const densidadesPorAño = {};\n    colabsXtotal.forEach(dato => {\n      const {\n        year,\n        numColabs,\n        numPapersAndArticles\n      } = dato;\n      if (!densidadesPorAño[year]) {\n        densidadesPorAño[year] = 0;\n      }\n      densidadesPorAño[year] += numColabs / numPapersAndArticles;\n    });\n    const density = Object.entries(densidadesPorAño).map(([year, density]) => ({\n      year: parseInt(year),\n      density\n    }));\n    this.statistics[3] = {\n      years: density.map(dato => dato.year),\n      densidades: density.map(dato => dato.density)\n    };\n  }\n  // Function to generate and save statistics of Single authors\n  statsSingleAuthor() {\n    const papersWithAuthors = [];\n    this.singleAuthor.forEach(author => {\n      author.ipNames.forEach(ipName => {\n        const paperIndex = papersWithAuthors.findIndex(paper => paper.ipName === ipName);\n        if (paperIndex !== -1) {\n          papersWithAuthors[paperIndex].numAuthors++;\n          papersWithAuthors[paperIndex].authorNames.push(author.researcher);\n        } else {\n          papersWithAuthors.push({\n            ipName,\n            numAuthors: 1,\n            authorNames: [author.researcher],\n            year: author.year\n          });\n        }\n      });\n    });\n    this.papersAndarticlesWithAuthors = papersWithAuthors;\n    const papersAndarticlesWithOneAuthor = papersWithAuthors.filter(item => item.numAuthors === 1);\n    const porcentajeByYear = this.PapersAndArticles.map(item => {\n      const year = item.year;\n      const numPapersAndArticles = item.numPapersAndArticles.low;\n      const numPapersAndArticlesWithSingleAuthor = papersAndarticlesWithOneAuthor.filter(item => item.year === year).length;\n      const percentage = numPapersAndArticlesWithSingleAuthor / numPapersAndArticles * 100;\n      return {\n        year,\n        percentage\n      };\n    });\n    this.statistics[4] = {\n      years: porcentajeByYear.map(dato => dato.year),\n      percentages: porcentajeByYear.map(dato => dato.percentage)\n    };\n    let years = this.statistics[4].years;\n    let percentages = this.statistics[4].percentages;\n    let dataByYear = {};\n    for (let i = 0; i < years.length; i++) {\n      let year = years[i];\n      let percentage = percentages[i];\n      if (!dataByYear[year]) {\n        dataByYear[year] = [percentage];\n      } else {\n        dataByYear[year].push(percentage);\n      }\n    }\n    let singleYear = [];\n    let AveragePercentages = [];\n    for (let año in dataByYear) {\n      let percentageYear = dataByYear[año];\n      let average = percentageYear.reduce((acc, curr) => acc + curr, 0) / percentageYear.length;\n      singleYear.push(año);\n      AveragePercentages.push(average);\n    }\n    this.statistics[4] = [];\n    this.statistics[4].years = singleYear;\n    this.statistics[4].percentages = AveragePercentages;\n    this.singlePapersAndArticle = this.statistics[4];\n    this.generateBarChart('barChart1', 'Single Author Papers and Single Author Journals', this.statistics[4].years, this.statistics[4].percentages);\n  }\n  // Function to generate and save geographical statistics\n  statsGeography(datasets) {\n    const mappingDate = {};\n    const datasetFiltered = datasets.filter(object => Object.keys(object.frecuencias).length > 0);\n    const uniqueDates = [...new Set(datasetFiltered.map(dato => dato.year))];\n    for (const date of uniqueDates) {\n      const objectDate = datasetFiltered.filter(dato => dato.year === date);\n      mappingDate[date] = {};\n      for (const object of objectDate) {\n        let countryHighest = '';\n        let highestFrequency = -1;\n        for (const country in object.frecuencias) {\n          if (object.frecuencias[country] > highestFrequency) {\n            countryHighest = country;\n            highestFrequency = object.frecuencias[country];\n          }\n        }\n        if (!(countryHighest in mappingDate[date])) {\n          mappingDate[date][countryHighest] = 1;\n        } else {\n          mappingDate[date][countryHighest] = mappingDate[date][countryHighest] + 1;\n        }\n      }\n    }\n    for (const year in mappingDate) {\n      let total = 0;\n      for (const country in mappingDate[year]) {\n        total += mappingDate[year][country];\n      }\n      for (const country in mappingDate[year]) {\n        mappingDate[year][country] = Number((mappingDate[year][country] / total).toFixed(4));\n      }\n    }\n    const years = Object.keys(mappingDate);\n    const countries = Object.keys(mappingDate[years[0]]);\n    const datasetsLabels = countries;\n    const datasetsData = countries.map(country => years.map(year => mappingDate[year][country]));\n    this.generateMultipleChart('lineChart5', years, datasetsLabels, datasetsData);\n  }\n  // Function to filter authors by decades\n  filterAuthorsByDecade(authors, startYear, endYear) {\n    const filteredAuthors = [];\n    authors.forEach(author => {\n      const authorYears = author.year.split(\",\").map(Number).filter(year => year >= startYear && year <= endYear);\n      if (authorYears.length > 0) {\n        const existingAuthor = filteredAuthors.find(filteredAuthor => filteredAuthor.researcher === author.researcher);\n        if (existingAuthor) {\n          existingAuthor.numPublications += author.numPublications;\n          existingAuthor.year += `, ${author.year}`;\n        } else {\n          filteredAuthors.push({\n            ipNames: author.ipNames,\n            numPublications: author.numPublications,\n            researcher: author.researcher,\n            year: author.year\n          });\n        }\n      }\n    });\n    return filteredAuthors;\n  }\n  // Function to find the most prolific authors of each decade\n  statsProlificAuthors(selectedYears) {\n    const startYear = Math.min(...selectedYears);\n    const endYear = Math.max(...selectedYears);\n    const startDecade = Math.floor(startYear / 10) * 10;\n    const endDecade = Math.floor(endYear / 10) * 10;\n    const decades = [];\n    for (let decade = startDecade; decade <= endDecade; decade += 10) {\n      const decadeLabel = `${decade}s`;\n      const decadeStartYear = decade;\n      const decadeEndYear = decade + 9;\n      const decadeAuthors = this.filterAuthorsByDecade(this.singleAuthor, decadeStartYear, decadeEndYear);\n      decades.push({\n        label: decadeLabel,\n        startYear: decadeStartYear,\n        endYear: decadeEndYear,\n        authors: decadeAuthors\n      });\n    }\n    decades.forEach(decade => {\n      decade.authors.sort((a, b) => b.numPublications - a.numPublications);\n      if (decade.authors.length > 20) {\n        decade.authors = decade.authors.slice(0, 20);\n      }\n    });\n    return decades;\n  }\n  // Function to generate the Degree table and save the degree of authors\n  statsDegreeAuthors(selectedYears) {\n    const startYear = Math.min(...selectedYears);\n    const endYear = Math.max(...selectedYears);\n    const allAuthors = this.filterAuthorsByDecade(this.singleAuthor, startYear, endYear);\n    const topAuthors = allAuthors.sort((a, b) => b.numPublications - a.numPublications).slice(0, 20);\n    const tables = {\n      'degree': document.querySelector('#degree tbody')\n    };\n    for (const author of topAuthors) {\n      const table = tables['degree'];\n      if (table instanceof HTMLElement) {\n        const yearsArray = author.year.split(\",\").map(Number);\n        const minYear = Math.min(...yearsArray);\n        const maxYear = Math.max(...yearsArray);\n        const row = document.createElement('tr');\n        row.innerHTML = `\n  \n                         <td >${author.researcher}</td>\n                         <td style=\"padding-left: 50px\" >${author.numPublications}</td>\n                         <td style=\"padding-left: 50px\">${minYear}</td> \n                         <td style=\"padding-left: 80px\">${maxYear}</td>`;\n        table.appendChild(row);\n      }\n    }\n  }\n  // Function to generate and save gender statistics\n  statsGender(datasets) {\n    const datasetsByGenre = {};\n    datasets.forEach(data => {\n      const {\n        year,\n        genero\n      } = data;\n      let genderKey = '';\n      if (genero == 'M' || genero == '?M' || genero == '1M' || genero == '?') {\n        genderKey = 'Men';\n      } else if (genero == 'F' || genero == '?F' || genero == '1F') {\n        genderKey = 'Women';\n      } else {\n        genderKey = 'Unknown';\n      }\n      if (!datasetsByGenre[genderKey]) {\n        datasetsByGenre[genderKey] = [];\n      }\n      const existingData = datasetsByGenre[genderKey].find(d => d.year === year);\n      if (existingData) {\n        existingData.count++;\n      } else {\n        datasetsByGenre[genderKey].push({\n          year,\n          count: 1\n        });\n      }\n    });\n    const sortedData = {};\n    const men = datasetsByGenre['Men'];\n    const women = datasetsByGenre['Women'];\n    men.forEach(dato => {\n      const year = dato.year;\n      const count = dato.count;\n      sortedData[year] = {\n        hombres: count,\n        mujeres: 0,\n        total: count\n      };\n    });\n    women.forEach(dato => {\n      const year = dato.year;\n      const count = dato.count;\n      if (sortedData[year]) {\n        sortedData[year].mujeres = count;\n        sortedData[year].total += count;\n      } else {\n        sortedData[year] = {\n          mujeres: count,\n          hombres: 0,\n          total: count\n        };\n      }\n    });\n    const organizedYears = Object.keys(sortedData).sort();\n    const countMen = organizedYears.map(anio => Number((sortedData[anio].hombres / sortedData[anio].total).toFixed(4)));\n    const countWoman = organizedYears.map(anio => Number((sortedData[anio].mujeres / sortedData[anio].total).toFixed(4)));\n    this.generateCircularChart('lineChart4', organizedYears, ['Hombres', 'Mujeres'], [countMen, countWoman]);\n    this.generateMultipleChart('lineChart8', organizedYears, ['Hombres', 'Mujeres'], [countMen, countWoman]);\n  }\n  // Function to generate the Decades table\n  generateTablesDecades(decadeStats) {\n    const tables = {\n      '1990s': document.querySelector('#table90 tbody'),\n      '2000s': document.querySelector('#table00 tbody'),\n      '2010s': document.querySelector('#table10 tbody'),\n      '2020s': document.querySelector('#table20 tbody')\n    };\n    for (const decade of decadeStats) {\n      const table = tables[decade.label];\n      if (table instanceof HTMLElement) {\n        decade.authors.slice(0, 20).forEach(autor => {\n          const row = document.createElement('tr');\n          row.innerHTML = `<td>${autor.researcher}</td><td>${autor.numPublications}</td>`;\n          table.appendChild(row);\n        });\n      }\n    }\n  }\n  // Function to generate charts of authors\n  generateTotalAuthorsChart(idChart, label, data) {\n    const years = data.map(entry => entry.year);\n    const totalAuthors = data.map(entry => entry.totalAuthors);\n    const totalPapers = data.map(entry => entry.totalPapers);\n    const totalArticles = data.map(entry => entry.totalArticles);\n    if (idChart == \"lineChart6\") {\n      this.lineChart = new Chart(idChart, {\n        type: 'line',\n        data: {\n          labels: years,\n          datasets: [{\n            label: label,\n            data: totalAuthors,\n            fill: false,\n            borderColor: 'rgb(0, 22, 68)',\n            borderWidth: 1\n          }]\n        },\n        options: {\n          plugins: {\n            legend: {\n              labels: {\n                color: 'black',\n                font: {\n                  size: 18,\n                  family: 'Roboto'\n                }\n              }\n            }\n          },\n          scales: {\n            y: {\n              type: 'linear',\n              display: true\n            }\n          }\n        }\n      });\n    }\n    if (idChart == \"lineChart7\") {\n      this.lineChart = new Chart(idChart, {\n        type: 'line',\n        data: {\n          labels: years,\n          datasets: [{\n            label: 'Papers',\n            data: totalPapers,\n            fill: false,\n            borderColor: \"rgba(51, 153, 255)\",\n            borderWidth: 1\n          }, {\n            label: 'Articles',\n            data: totalArticles,\n            fill: false,\n            borderColor: \"rgba(255, 0, 0, 1)\",\n            borderWidth: 1\n          }]\n        },\n        options: {\n          plugins: {\n            legend: {\n              labels: {\n                color: 'black',\n                font: {\n                  size: 18,\n                  family: 'Roboto'\n                }\n              }\n            }\n          },\n          scales: {\n            y: {\n              type: 'linear',\n              display: true\n            }\n          }\n        }\n      });\n    }\n  }\n  // Function to generate charts of articles and papers\n  generateChartPapersAndArticles(idChart, data) {\n    const datasets = data.map((entry, index) => ({\n      label: entry.name,\n      data: entry.numResearchers,\n      fill: false,\n      borderColor: this.getRandomColor(index),\n      borderWidth: 1\n    }));\n    if (idChart == \"lineChart2\") {\n      this.lineChart = new Chart(idChart, {\n        type: 'line',\n        data: {\n          labels: data[0].years,\n          datasets: datasets\n        },\n        options: {\n          plugins: {\n            legend: {\n              labels: {\n                color: 'black',\n                font: {\n                  size: 18,\n                  family: 'Roboto'\n                }\n              }\n            }\n          },\n          scales: {\n            y: {\n              type: 'linear',\n              display: true\n            }\n          }\n        }\n      });\n    }\n    if (idChart == \"lineChart1\") {\n      this.lineChart = new Chart(idChart, {\n        type: 'line',\n        data: {\n          labels: data[0].years,\n          datasets: datasets\n        },\n        options: {\n          plugins: {\n            legend: {\n              labels: {\n                color: 'black',\n                font: {\n                  size: 18,\n                  family: 'Roboto'\n                }\n              }\n            }\n          },\n          scales: {\n            y: {\n              type: 'linear',\n              display: true\n            }\n          }\n        }\n      });\n    }\n  }\n  // Function to generate the density chart\n  generateChartDensity(idChart, label, labels, data) {\n    this.lineChart = new Chart(idChart, {\n      type: 'line',\n      data: {\n        labels: labels,\n        datasets: [{\n          label: label,\n          data: data,\n          fill: false,\n          borderColor: 'rgb(0, 22, 68)',\n          borderWidth: 1\n        }]\n      },\n      options: {\n        plugins: {\n          legend: {\n            labels: {\n              color: 'black',\n              font: {\n                size: 18,\n                family: 'Roboto'\n              }\n            }\n          }\n        },\n        scales: {\n          y: {\n            type: 'linear',\n            display: true\n          }\n        }\n      }\n    });\n  }\n  //Function to generate a Multiple Chart of Gender\n  generateMultipleChart(chartId, labels, datasetsLabels, datasetsData) {\n    const datasets = datasetsLabels.map((label, index) => ({\n      label: label,\n      data: datasetsData[index],\n      fill: false,\n      borderColor: this.getRandomColor(index),\n      borderWidth: 1\n    }));\n    const chartConfig = {\n      type: 'line',\n      data: {\n        labels: labels,\n        datasets: datasets\n      },\n      options: {\n        plugins: {\n          legend: {\n            labels: {\n              color: 'black',\n              font: {\n                size: 18,\n                family: 'Roboto'\n              }\n            }\n          }\n        },\n        scales: {\n          y: {\n            type: 'linear',\n            display: true\n          }\n        }\n      }\n    };\n    const ctx = document.getElementById(chartId);\n    new Chart(ctx, chartConfig);\n  }\n  //Function to generate a Circular Chart of Gender\n  generateCircularChart(chartId, labels, datasetsLabels, datasetsData) {\n    const colors = ['#FF5733', '#3399FF'];\n    const datasets = datasetsLabels.map((label, index) => ({\n      label: label,\n      data: datasetsData[index],\n      backgroundColor: colors[index],\n      borderColor: 'black'\n    }));\n    const chartConfig = {\n      type: 'pie',\n      data: {\n        labels: labels,\n        datasets: datasets\n      },\n      options: {\n        plugins: {\n          legend: {\n            display: false,\n            labels: {\n              color: 'black',\n              font: {\n                size: 18,\n                family: 'Roboto'\n              }\n            }\n          }\n        }\n      }\n    };\n    const ctx = document.getElementById(chartId);\n    new Chart(ctx, chartConfig);\n  }\n  //Function to generate a Chart of SingleAuthors\n  generateBarChart(idChart, label, labels, data) {\n    this.barChart = new Chart(idChart, {\n      type: 'bar',\n      data: {\n        labels: labels,\n        datasets: [{\n          label: label,\n          data: data,\n          backgroundColor: 'rgb(0, 22, 68)',\n          borderColor: 'rgb(0, 22, 68)',\n          borderWidth: 1\n        }]\n      },\n      options: {\n        plugins: {\n          legend: {\n            labels: {\n              color: 'black',\n              font: {\n                size: 18,\n                family: 'Roboto'\n              }\n            }\n          }\n        },\n        scales: {\n          y: {\n            beginAtZero: true\n          }\n        }\n      }\n    });\n  }\n  // randomColor(){\n  //   const r = Math.floor(Math.random() * 256);\n  //   const g = Math.floor(Math.random() * 256);\n  //   const b = Math.floor(Math.random() * 256);\n  //   return `rgba(${r}, ${g}, ${b}, 1)`;\n  // }\n  // Function to generate a random color\n  getRandomColor(index) {\n    let colors = {\n      0: \"rgba(51, 153, 255)\",\n      1: \"rgba(255, 0, 0, 1)\",\n      2: \"rgba(98, 192, 75, 1)\",\n      3: \"rbga(192, 141, 75, 1)\",\n      4: \"rgba(226, 232, 107, 1)\",\n      5: \"rgba(176, 75, 192, 1)\",\n      6: \"rgba(255, 153, 51, 1)\",\n      7: \"rgba(102, 204, 204, 1)\",\n      8: \"rgba(255, 102, 204, 1)\",\n      9: \"rgba(153, 102, 204, 1)\",\n      10: \"rgba(255, 204, 102, 1)\" // Amarillo suave\n    };\n\n    return colors[index];\n  }\n  // Function to load the file with the list of names \n  loadCommonNames() {\n    this.http.get('assets/common_names.txt', {\n      responseType: 'text'\n    }).subscribe(data => {\n      this.commonNames = this.parseCommonNames(data);\n    }, error => {\n      console.error('Error al cargar los datos:', error);\n    });\n  }\n  // Function to analyze common names\n  parseCommonNames(data) {\n    const lines = data.split('\\n');\n    const dict = {};\n    let currentName = '';\n    let currentData = {\n      frec_paises: {},\n      genero: ''\n    };\n    for (const linea of lines) {\n      if (linea.startsWith('nombre:')) {\n        currentName = linea.split(':')[1].trim();\n        currentData = {\n          frec_paises: {},\n          genero: ''\n        };\n      } else if (linea.startsWith('frec_paises:')) {\n        const frec_paisesStr = linea.substring(linea.indexOf('{'), linea.lastIndexOf('}') + 1);\n        const frec_paises = JSON.parse(frec_paisesStr);\n        currentData.frec_paises = frec_paises;\n      } else if (linea.startsWith('genero:')) {\n        currentData.genero = linea.split(':')[1].trim();\n      } else if (linea.trim() === '') {\n        dict[currentName] = currentData;\n      }\n    }\n    return dict;\n  }\n  // Async functions to wait for data\n  waitResearcherNoEmpty() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      while (!_this2.researchers || _this2.researchers.length === 0) {\n        yield new Promise(resolve => setTimeout(resolve, 100));\n      }\n    })();\n  }\n  waitPapersAndArticlesNoEmpty() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      while (!_this3.PapersAndArticles || _this3.PapersAndArticles.length === 0) {\n        yield new Promise(resolve => setTimeout(resolve, 100));\n      }\n    })();\n  }\n  waitAuthorsWithPapersAndArticlesNoEmpty() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      while (!_this4.papersAndarticlesWithAuthors || _this4.papersAndarticlesWithAuthors.length === 0) {\n        yield new Promise(resolve => setTimeout(resolve, 100));\n      }\n    })();\n  }\n  waitSingleAuthorsNoEmpty() {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      while (!_this5.singleAuthor || _this5.singleAuthor.length === 0) {\n        yield new Promise(resolve => setTimeout(resolve, 100));\n      }\n    })();\n  }\n  main() {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        if (_this6.stadisticsService.ConferenceOrJournalConfirm != _this6.stadisticsService.getConferenceOrJournalName()) {\n          _this6.getConferencebyProceeding();\n        } else {\n          _this6.generateTablesProceeding(_this6.stadisticsService.ConferenceOrJournalNames, _this6.stadisticsService.years, _this6.stadisticsService.inprocedings);\n        }\n        _this6.getResearchersConferenceAndJournals();\n        _this6.getPapersAndArticles();\n        _this6.getConferencebyProceeding();\n        if (_this6.researchers.length == 0) {\n          yield _this6.waitResearcherNoEmpty();\n          _this6.getDemographicData();\n        } else {\n          _this6.getDemographicData();\n        }\n        if (_this6.PapersAndArticles.length == 0) {\n          yield _this6.waitPapersAndArticlesNoEmpty();\n          _this6.getCollaborations();\n          _this6.getAuthorsPapersAndArticles();\n        } else {\n          _this6.getCollaborations();\n          ;\n          _this6.getAuthorsPapersAndArticles();\n        }\n        while (_this6.collaborations.length < 1) {\n          _this6.loadingTable2 = true;\n          yield new Promise(resolve => setTimeout(resolve, 1000));\n          _this6.spinnerService.show();\n        }\n        _this6.loadingTable2 = false;\n        if (_this6.papersAndarticlesWithAuthors.length == 0) {\n          yield _this6.waitAuthorsWithPapersAndArticlesNoEmpty();\n          _this6.getTopicAnalysis();\n          _this6.getDistributions();\n        } else {\n          _this6.getTopicAnalysis();\n          _this6.getDistributions();\n        }\n        if (_this6.singleAuthor.length == 0) {\n          yield _this6.waitSingleAuthorsNoEmpty();\n          _this6.decadeStats = _this6.statsProlificAuthors(_this6.selectedYears);\n          _this6.generateTablesDecades(_this6.decadeStats);\n        } else {\n          _this6.decadeStats = _this6.statsProlificAuthors(_this6.selectedYears);\n          _this6.generateTablesDecades(_this6.decadeStats);\n        }\n        _this6.statsDegreeAuthors(_this6.selectedYears);\n        while (_this6.stadisticsService.ConferenceOrJournalNames.length < 1) {\n          _this6.loadingTable1 = true;\n          yield new Promise(resolve => setTimeout(resolve, 100));\n          _this6.spinnerService.show();\n        }\n        _this6.loadingTable1 = false;\n        _this6.stadisticsService.ConferenceOrJournalConfirm = _this6.stadisticsService.getConferenceOrJournalName();\n      } catch (error) {\n        console.error('Error in getData with:', error);\n      }\n    })();\n  }\n};\n__decorate([ViewChild('chartCanvas')], StatisticsComponent.prototype, \"chartCanvas\", void 0);\nStatisticsComponent = __decorate([Component({\n  selector: 'statistics',\n  templateUrl: './statistics.component.html',\n  styleUrls: ['./statistics.component.scss']\n})], StatisticsComponent);\nexport { StatisticsComponent };","map":{"version":3,"names":["Component","ViewChild","Chart","registerables","singular","register","StatisticsComponent","constructor","apiService","stadisticsService","http","spinnerService","selectedYears","PapersAndArticles","collaborations","singleAuthor","statistics","statsAuthors","statsPaperAndArticle","ConferencesAndJournalCount","ConferencesAndJournalAuthors","totalAuthorsByYear","PapersAndArticlesByYear","totalArticlesByYear","totalPapersByYear","singlePapersAndArticle","decadeStats","researchers","papersAndarticlesWithAuthors","loadingTable1","loadingTable2","commonNames","options","width","height","overflow","realignOnResize","strict","step","cloudData","ngOnInit","loadCommonNames","main","getResearchersConferenceAndJournals","selectedTitles","ConferenceOrJournalName","subscribe","next","response","statsResearchers","statsTotalAuthorsByYear","length","generateChartPapersAndArticles","generateTotalAuthorsChart","error","console","getPapersAndArticles","statsPapersAndArticles","statsTotalPapersAndArticlesByYear","getCollaborations","statsColaboraciones","generateChartDensity","years","densidades","getConferencebyProceeding","ConferenceOrJournalNames","inprocedings","forEach","title","year","numberOfInProceedings","push","generateTablesProceeding","getAuthorsPapersAndArticles","_this","_ref","_asyncToGenerator","statsSingleAuthor","_x","apply","arguments","sort","a","b","parseInt","map","totalAuthors","reduce","total","researcher","includes","item","filter","value","index","self","indexOf","papersByYear","type","articlesByYear","papersOfYear","paper","articlesOfYear","article","totalPapers","numPapersAndArticles","low","totalArticles","venueTitles","table","document","querySelector","HTMLElement","innerHTML","venueTitle","parts","split","replace","date","rowData","name","trim","location","slice","join","row","createElement","appendChild","hasNumber","test","isValidFormat","getDistributions","labels","authorsByPaper","numAuthors","allPapers","all","papersByAuthor","numPubs","numPublications","allAuthors","authorsTable","papersTable","amount","percentage","toFixed","worth","toString","getDemographicData","datasets","properties","Array","isArray","datasetByYear","info","genero","frecuencias","frec_paises","flat","statsGender","statsGeography","generateNGrams","titles","n","ngrams","words","toLowerCase","i","countFrequencies","frequencies","Map","ngram","count","get","set","clearTitle","stopwords","word","wordsNoRepeat","singularWords","filteredWords","newTitle","getTopN","sortedFrequencies","entries","getTopicAnalysis","cleanTitles","ipName","bigrams","trigrams","bigramFrequencies","trigramFrequencies","top20Bigrams","top20Trigrams","top20BigramsWithYears","top20TrigramsWithYears","table1","table2","minYear","Math","min","maxYear","max","combinedData","maxFrecuencia","minWeight","maxWeight","wordCloudData","text","weight","calculateWeight","color","getRandomColor","frec","maxFrec","normWeight","round","names","Set","size","from","numResearchersPorAnio","anio","numResearchers","numPapersAndArticlesPorAnio","colabsXtotal","colabsPapers","colab","find","c","integer","numColabs","concat","densidadesPorAño","dato","density","Object","papersWithAuthors","author","ipNames","paperIndex","findIndex","authorNames","papersAndarticlesWithOneAuthor","porcentajeByYear","numPapersAndArticlesWithSingleAuthor","percentages","dataByYear","singleYear","AveragePercentages","año","percentageYear","average","acc","curr","generateBarChart","mappingDate","datasetFiltered","object","keys","uniqueDates","objectDate","countryHighest","highestFrequency","country","Number","countries","datasetsLabels","datasetsData","generateMultipleChart","filterAuthorsByDecade","authors","startYear","endYear","filteredAuthors","authorYears","existingAuthor","filteredAuthor","statsProlificAuthors","startDecade","floor","endDecade","decades","decade","decadeLabel","decadeStartYear","decadeEndYear","decadeAuthors","label","statsDegreeAuthors","topAuthors","tables","yearsArray","datasetsByGenre","data","genderKey","existingData","d","sortedData","men","women","hombres","mujeres","organizedYears","countMen","countWoman","generateCircularChart","generateTablesDecades","autor","idChart","entry","lineChart","fill","borderColor","borderWidth","plugins","legend","font","family","scales","y","display","chartId","chartConfig","ctx","getElementById","colors","backgroundColor","barChart","beginAtZero","responseType","parseCommonNames","lines","dict","currentName","currentData","linea","startsWith","frec_paisesStr","substring","lastIndexOf","JSON","parse","waitResearcherNoEmpty","_this2","Promise","resolve","setTimeout","waitPapersAndArticlesNoEmpty","_this3","waitAuthorsWithPapersAndArticlesNoEmpty","_this4","waitSingleAuthorsNoEmpty","_this5","_this6","ConferenceOrJournalConfirm","getConferenceOrJournalName","show","__decorate","selector","templateUrl","styleUrls"],"sources":["/home/miguel/Collaboration_Networks/interfaz/src/app/statistics/statistics.component.ts"],"sourcesContent":["import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { ApiService } from '../services/api.service';\nimport { StadisticsService } from '../services/stadistics.service';\nimport { Chart, registerables } from 'chart.js';\nimport { HttpClient } from '@angular/common/http';\nimport { CloudData, CloudOptions } from 'angular-tag-cloud-module';\nimport { singular } from 'pluralize';\nimport { ChartConfiguration } from 'chart.js';\nimport { SpinnerService } from '../services/spinner.service';\nimport { Author } from '../models/statistics.model';\nimport { DecadeStats } from '../models/statistics.model';\n\nChart.register(...registerables);\n\n\n\n@Component({\n  selector: 'statistics',\n  templateUrl: './statistics.component.html',\n  styleUrls: ['./statistics.component.scss'],\n})\n\nexport class StatisticsComponent implements OnInit {\n  @ViewChild('chartCanvas') chartCanvas!: ElementRef;\n\n  selectedYears: any[] = [];\n  PapersAndArticles: any[] = [];\n  collaborations: any[] = [];\n  singleAuthor: any[] = [];\n  statistics: any[] = [];\n  statsAuthors: any[] = []\n  statsPaperAndArticle: any[] = []\n  ConferencesAndJournalCount: number = 0;\n  ConferencesAndJournalAuthors: number = 0;\n  lineChart!: Chart;\n  barChart!: Chart;\n  totalAuthorsByYear: any[] = []\n  PapersAndArticlesByYear: any[] = []\n  totalArticlesByYear: any[] = []\n  totalPapersByYear: any[] = []\n  singlePapersAndArticle: any[] = []\n  decadeStats: any[] = [];\n  researchers: any[] = [];\n  papersAndarticlesWithAuthors: any[] = [];\n  loadingTable1 = true;\n  loadingTable2 = true;\n  commonNames: { [key: string]: { frec_paises: { [key: string]: number }, genero: string } } = {};\n\n  options: CloudOptions = {\n    width: 500,\n    height: 200,\n    overflow: false,\n    realignOnResize: false,\n    strict: false,\n    step: 2,\n  };\n\n  cloudData: CloudData[] = []\n\n  constructor(\n    private apiService: ApiService,\n    private stadisticsService: StadisticsService,\n    private http: HttpClient,\n    private spinnerService: SpinnerService,\n  ) {}\n\n  ngOnInit() {\n    this.loadCommonNames();\n    this.main();\n  }\n\n  // API CALL: Function to search for authors of conferences and journals\n  getResearchersConferenceAndJournals() {\n    this.apiService.getResearchersConferenceAndJournals(this.stadisticsService.selectedTitles, this.stadisticsService.ConferenceOrJournalName).subscribe({\n      next: (response: any) => {\n        this.researchers = [];\n        this.researchers = response;\n        this.statsResearchers();\n        this.statsTotalAuthorsByYear();\n        if(this.researchers.length > 1){\n          this.generateChartPapersAndArticles('lineChart1', this.statsAuthors);\n          this.generateTotalAuthorsChart('lineChart6', 'Total Authors by Year', this.totalAuthorsByYear);\n        }\n      },\n      error: (error: any) => {\n        console.error('Error in getResearchersConference:', error);\n      }\n    });\n  }\n  \n  // API CALL: Function to search for papers and articles of conferences and journals\n  getPapersAndArticles() {\n    this.apiService.getPapersAndArticles(this.stadisticsService.selectedTitles, this.stadisticsService.ConferenceOrJournalName).subscribe({\n      next: (response: any) => {\n        this.PapersAndArticles = response;\n        if(this.PapersAndArticles.length > 0){\n          this.statsPapersAndArticles();\n          this.statsTotalPapersAndArticlesByYear();\n     \n        }\n      },\n      error: (error: any) => {\n        console.error('Error in getPapers:', error);\n      }\n    });\n  }\n\n  // API CALL: Function to find collaborations of journals and conferences\n  getCollaborations() {\n    this.apiService.getCollaborations(this.stadisticsService.selectedTitles, this.stadisticsService.ConferenceOrJournalName).subscribe({\n      next: (response: any) => {\n        this.collaborations = response;\n        this.statsColaboraciones();\n        this.generateChartDensity('lineChart3', 'Density', this.statistics[3].years, this.statistics[3].densidades);\n      },\n      error: (error: any) => {\n        console.error('Error in getCollaborations:', error);\n      }\n    });\n  }\n\n  // API CALL: Function to find the conference by proceeding\n  getConferencebyProceeding(){\n    this.apiService.getConferencebyProceeding(this.stadisticsService.selectedTitles, this.stadisticsService.ConferenceOrJournalName).subscribe({\n      next: (response: any) => {\n        this.stadisticsService.ConferenceOrJournalNames = [];\n        this.stadisticsService.years = [];\n        this.stadisticsService.inprocedings = [];\n      \n        response.forEach(({ title, year, numberOfInProceedings }: { title: string, year: string, numberOfInProceedings: number}) => {\n          this.stadisticsService.ConferenceOrJournalNames.push(title);\n          this.stadisticsService.years.push(year);\n          this.stadisticsService.inprocedings.push(numberOfInProceedings);\n        });\n        this.loadingTable1 = false;\n      \n        this.generateTablesProceeding(this.stadisticsService.ConferenceOrJournalNames, this.stadisticsService.years, this.stadisticsService.inprocedings);\n     \n      },\n      error: (error: any) => {\n        console.error('Error in getConferencebyProceeding:', error);\n      }\n    });\n  }\n\n  // API CALL: Function to find the authors of papers and articles\n  getAuthorsPapersAndArticles() {\n    this.apiService.getAuthorsPapersAndArticles(this.stadisticsService.selectedTitles, this.stadisticsService.ConferenceOrJournalName)\n      .subscribe({\n        next: async (response: any) => {\n          this.singleAuthor = response;\n          this.statsSingleAuthor();\n          \n        },\n        error: (error: any) => {\n          console.error('Error in getAuthorsPapers:', error);\n        }\n      });\n  }\n\n  // Function to save the total number of authors per year\n  statsTotalAuthorsByYear() {\n    const years = this.stadisticsService.selectedTitles;\n    years.sort((a, b) => parseInt(a) - parseInt(b));\n    this.totalAuthorsByYear = years.map(year => {\n      const totalAuthors = this.researchers.reduce((total, researcher) => {\n        if (researcher.years.includes(year)) {\n          return total + 1;\n        }\n        return total;\n      }, 0);\n      return {\n        year: year,\n        totalAuthors: totalAuthors\n      };\n    });\n  }\n\n  // Function to save the total number of papers and articles per year\n  statsTotalPapersAndArticlesByYear() {\n    let years = this.PapersAndArticles.map(item => item.year);\n    years = years.filter((value, index, self) => self.indexOf(value) === index); \n    years.sort((a, b) => parseInt(a) - parseInt(b)); \n    \n    const papersByYear = this.PapersAndArticles.filter(item => item.type === \"Paper\");\n    const articlesByYear = this.PapersAndArticles.filter(item => item.type === \"Article\");\n\n    this.PapersAndArticlesByYear = years.map(year => {\n      const papersOfYear = papersByYear.filter(paper => paper.year === year);\n      const articlesOfYear = articlesByYear.filter(article => article.year === year);\n      \n      const totalPapers = papersOfYear.reduce((total, paper) => {\n        return total + paper.numPapersAndArticles.low;\n      }, 0);\n      \n      const totalArticles = articlesOfYear.reduce((total, article) => {\n        return total + article.numPapersAndArticles.low;\n      }, 0);\n\n      return {\n        year: year,\n        totalPapers: totalPapers,\n        totalArticles: totalArticles\n      };\n    });\n    \n    this.generateTotalAuthorsChart('lineChart7', 'Total Papers and Articles by Year', this.PapersAndArticlesByYear);\n  }\n\n  // Function to generate the table of conferences, including specific exceptions\n  generateTablesProceeding(venueTitles: string[], years: string[], numberOfInProceedings: number[]) {\n    const table = document.querySelector('#tableProceeding tbody');\n    if (table instanceof HTMLElement) {\n      table.innerHTML = ''; \n  \n      venueTitles.forEach((venueTitle, index) => {\n\n        const parts = venueTitle.split(',');\n\n        if( parts.length== 6){\n            \n          parts[4]= parts[4].replace(\"Proceedings\",\"\");\n          const date = parts[4].split('.')\n          \n          const rowData = {\n            name: parts[0] + '-' + parts[1].trim(),\n            location: parts[2] + ',' + parts[3],\n            date: date.slice(0).join(' ')\n          };\n\n          const row = document.createElement('tr');\n          row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n          \n          table.appendChild(row);\n        }\n\n        if(parts.length== 5){\n          \n          parts[3] = parts[3].replace(\"Proceedings\",\"\").trim();\n          const date = parts[3].split('.')\n          const hasNumber = /\\d/.test(date[0]);\n\n          if(hasNumber){\n\n            if(parts[1].includes(\"Florence\")){\n \n              const rowData = {\n                name: parts[0],\n                location: parts[1].trim() + ',' + parts[2],\n                date: date[0]\n              };\n              const row = document.createElement('tr');\n              row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n              table.appendChild(row);\n\n            }else{\n\n              const rowData = {\n                name: parts[0] + '-' + parts[1].trim(),\n                location: parts[2],\n                date: date[0]\n              };\n              const row = document.createElement('tr');\n              row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n              table.appendChild(row);\n            }\n\n          }else{\n\n            const rowData = {\n              name: parts[0] + '-' + parts[1].trim(),\n              location: parts[2] + ', ' + parts[3],\n              date: parts[4] \n            };\n\n            const row = document.createElement('tr');\n            row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n            table.appendChild(row);\n          }\n\n        }\n\n        if( parts.length== 7){\n            \n          parts[5]= parts[5].replace(\"Proceedings\",\"\");\n          const date = parts[5].split('.')\n\n          if(parts[2].length > 15){\n          const rowData = {\n            name: parts[0] + '-' + parts[1].trim(),\n            location: parts[3] + ', ' + parts[4],\n            date: date[0]\n          };\n          const row = document.createElement('tr');\n          row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n          table.appendChild(row);\n\n          } else {\n\n            const isValidFormat = /^[a-zA-Z]+\\s+\\d{1,2}(-\\d{1,2}|\\d{1,2}[a-zA-Z]+\\s+\\d{1,2})$/.test(date[0].trim());\n\n            if(isValidFormat){\n\n              if(parts[2].includes(\"ER\")){\n \n                const rowData = {\n                  name: parts[0] + ',' + parts[1].trim() + '-' +  parts[2] ,\n                  location: parts[3] + ', ' + parts[4],\n                  date: date[0]\n                };\n                const row = document.createElement('tr');\n                row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n                table.appendChild(row);\n              }else{\n\n                const rowData = {\n                  name: parts[0] + '-' + parts[1].trim(),\n                  location: parts[2]+ ', ' + parts[3] + ', ' + parts[4],\n                  date: date[0]\n                };\n    \n                const row = document.createElement('tr');\n                row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n                table.appendChild(row);\n\n              }\n\n            }else{\n                            \n            const rowData = {\n              name: parts[0] + '-' + parts[1].trim(),\n              location: parts[2] + ', ' + parts[3],\n              date: parts[4] + ', ' + date[0]\n            };\n            const row = document.createElement('tr');\n            row.innerHTML = `<td>${rowData.name}</td><td>${rowData.location}</td><td>${rowData.date}</td><td>${years[index]}</td><td>${numberOfInProceedings[index]}</td>`;\n            table.appendChild(row);\n            }\n  \n          }       \n        }  \n      });\n    }\n  }\n\n  // Function to obtain the distributions of both authors by papers and papers by authors\n  getDistributions(){\n    const labels: string[] = ['1', '2', '3', '4', '5 o más'];\n\n    const authorsByPaper: number[] = [1, 2, 3, 4].map((numAuthors) =>\n    this.papersAndarticlesWithAuthors.filter((item) => item.numAuthors === numAuthors).length\n    );\n    authorsByPaper[4] = this.papersAndarticlesWithAuthors.filter((item) => item.numAuthors >= 5).length;\n    let allPapers = this.PapersAndArticles.reduce((all, item) => all + item.numPapersAndArticles.low, 0);\n\n    const papersByAuthor: number[] = [1, 2, 3, 4].map((numPubs) =>\n    this.singleAuthor.filter((paper) => paper.numPublications === numPubs).length\n    );\n    papersByAuthor[4] = this.singleAuthor.filter((paper) => paper.numPublications >= 5).length\n    const allAuthors = this.singleAuthor.length;\n\n    const authorsTable = document.querySelector('#authorsTable tbody');\n    const papersTable = document.querySelector('#papersTable tbody');\n\n    if (authorsTable !== null) {\n      authorsByPaper.forEach((amount, index) => {\n        const row = document.createElement('tr');\n        const percentage = (amount / allPapers * 100).toFixed(2);\n        const worth = amount.toString() + \"(\" + percentage + \")\";\n        row.innerHTML = `<td>${labels[index]}</td><td>${worth}</td>`;\n        authorsTable.appendChild(row);\n      });\n    }\n\n    if (papersTable !== null) {\n      papersByAuthor.forEach((amount, index) => {\n        const row = document.createElement('tr');\n        const percentage = (amount / allAuthors * 100).toFixed(2);\n        const worth = amount.toString() + \"(\" + percentage + \")\";\n        row.innerHTML = `<td>${labels[index]}</td><td>${worth}</td>`;\n        papersTable.appendChild(row);\n      });\n    }\n  }\n\n\n  // Function to save demographic data\n  getDemographicData(){\n      const datasets = this.researchers.map(researcher => {\n        let name = researcher.researcher.properties.name.split(' ')[0];\n        if(name.includes(\"-\")){\n          name = name.split('-')[0];\n        }\n        const years = Array.isArray(researcher.years) ? researcher.years : [researcher.years];\n      \n        const datasetByYear = years.map((year: any) => {\n          const info = this.commonNames[name];\n          const genero = info ? info.genero : 'Unknown';\n          const frecuencias = info ? info.frec_paises : {};\n      \n          return {\n            year,\n            name,\n            genero,\n            frecuencias\n          };\n        });\n        return datasetByYear;\n      }).flat(); \n\n      this.statsGender(datasets);\n      this.statsGeography(datasets);\n  }\n\n  // Function to generate n-grams\n  generateNGrams(titles: string[], n: number): string[] {\n    const ngrams: string[] = [];\n    titles.forEach((title) => {\n      const words = title.toLowerCase().split(\" \");\n      for (let i = 0; i < words.length - n + 1; i++) {\n        ngrams.push(words.slice(i, i + n).join(\" \"));\n      }\n    });\n    return ngrams;\n  }\n  \n  // Function to count frequencies\n  countFrequencies(ngrams: string[]): Map<string, number> {\n    const frequencies = new Map<string, number>();\n    ngrams.forEach((ngram) => {\n      const count = frequencies.get(ngram) || 0;\n      frequencies.set(ngram, count + 1);\n    });\n    return frequencies;\n  }\n\n  // Function to clean the title\n  clearTitle(title: string, stopwords: string[]) {\n\n    const words = title.toLowerCase().split(\" \").map(word => word.replace(/[^\\w\\s]/g, \"\"));\n    const wordsNoRepeat = words.map(word => word.replace(/(.)\\1+/g, \"$1\"));\n    const singularWords = wordsNoRepeat.map(word => singular(word));\n    const filteredWords = singularWords.filter(word => !stopwords.includes(word));\n    const newTitle = filteredWords.join(' ');\n    \n    return newTitle;\n  }\n\n  // Function that returns an array with the highest frequencies\n  getTopN(frequencies: Map<string, number>, n: number): [string, number][] {\n    const sortedFrequencies = [...frequencies.entries()].sort((a, b) => b[1] - a[1]);\n    return sortedFrequencies.slice(0, n);\n  }\n\n  // Function to generate the table of bigrams and trigrams\n  getTopicAnalysis(){\n\n      const stopwords = ['i', 'me', 'my', 'myself', 'we', 'our', 'ours', 'ourselves', 'you', 'your', 'yours', 'yourself', 'yourselves', 'he', 'him', 'his', 'himself', 'she', 'her', 'hers', 'herself', 'it', 'its', 'itself', 'they', 'them', 'their', 'theirs', 'themselves', 'what', 'which', 'who', 'whom', 'this', 'that', 'these', 'those', 'am', 'is', 'are', 'was', 'were', 'be', 'been', 'being', 'have', 'has', 'had', 'having', 'do', 'does', 'did', 'doing', 'a', 'an', 'the', 'and', 'but', 'if', 'or', 'because', 'as', 'until', 'while', 'of', 'at', 'by', 'for', 'with', 'about', 'against', 'between', 'into', 'through', 'during', 'before', 'after', 'above', 'below', 'to', 'from', 'up', 'down', 'in', 'out', 'on', 'off', 'over', 'under', 'again', 'further', 'then', 'once', 'here', 'there', 'when', 'where', 'why', 'how', 'all', 'any', 'both', 'each', 'few', 'more', 'most', 'other', 'some', 'such', 'no', 'nor', 'not', 'only', 'own', 'same', 'so', 'than', 'too', 'very', 's', 't', 'can', 'will', 'just', 'don', 'should', 'now', '.', ','];\n\n      const cleanTitles = this.papersAndarticlesWithAuthors.map(item => {\n        const ipName = this.clearTitle(item.ipName, stopwords);\n        const year = parseInt(item.year);\n        return { ipName, year };\n      });\n\n      const bigrams = this.generateNGrams(cleanTitles.map((item) => item.ipName), 2);\n      const trigrams = this.generateNGrams(cleanTitles.map((item) => item.ipName), 3);\n\n      const bigramFrequencies = this.countFrequencies(bigrams);\n      const trigramFrequencies = this.countFrequencies(trigrams);\n\n      const top20Bigrams = this.getTopN(bigramFrequencies, 20);\n      const top20Trigrams = this.getTopN(trigramFrequencies, 20);\n\n    \n      const top20BigramsWithYears = top20Bigrams.map(([ngram, count]) => ({\n        ngram,\n        count,\n        years: cleanTitles.filter((paper) => paper.ipName.includes(ngram)).map((paper) => paper.year),\n      }));\n    \n      const top20TrigramsWithYears = top20Trigrams.map(([ngram, count]) => ({\n        ngram,\n        count,\n        years: cleanTitles.filter((paper) => paper.ipName.includes(ngram)).map((paper) => paper.year),\n      }));\n\n      const table1 = document.querySelector('#tableBigramas tbody');\n      const table2 = document.querySelector('#tableTrigramas tbody');\n    \n      if (table1 instanceof HTMLElement && table2 instanceof HTMLElement) {\n        top20BigramsWithYears.forEach(({ ngram, count, years }) => {\n          const minYear = Math.min(...years);\n          const maxYear = Math.max(...years);\n      \n          const row = document.createElement('tr');\n          row.innerHTML = `<td>${ngram}</td><td>${count}</td><td>${minYear}</td><td>${maxYear}</td>`;\n      \n          table1.appendChild(row);\n        });\n      \n        top20TrigramsWithYears.forEach(({ ngram, count, years }) => {\n          const minYear = Math.min(...years);\n          const maxYear = Math.max(...years);\n      \n          const row = document.createElement('tr');\n          row.innerHTML = `<td>${ngram}</td><td>${count}</td><td>${minYear}</td><td>${maxYear}</td>`;\n      \n          table2.appendChild(row);\n        });\n      }\n\n      const combinedData = [...top20BigramsWithYears, ...top20TrigramsWithYears];\n      \n      combinedData.sort((a, b) => b.count - a.count);\n\n      const maxFrecuencia = combinedData[0].count;\n      const minWeight = 0;\n      const maxWeight = 20;\n\n\n      const wordCloudData = combinedData.map((item, index) => ({\n        text: item.ngram,\n        weight: this.calculateWeight(item.count, maxFrecuencia, minWeight, maxWeight),\n        color: this.getRandomColor(index)\n      }));\n\n      this.cloudData = wordCloudData;\n     \n  }\n\n  // Function to calculate the weight\n  calculateWeight(frec: number, maxFrec: number, minWeight: number, maxWeight: number): number {\n    const weight = frec / maxFrec;\n    const normWeight = weight * (maxWeight - minWeight) + minWeight;\n    return Math.round(normWeight);\n  }\n\n  // Function to save author statistics\n  statsResearchers() {\n    const names = new Set(this.researchers.map(researcher => researcher.name));\n    this.ConferencesAndJournalAuthors = names.size;\n    this.statsAuthors = [];\n    this.statsAuthors = Array.from(names).map(name => {\n      const years = this.stadisticsService.selectedTitles;\n      years.sort((a, b) => parseInt(a) - parseInt(b));\n      this.selectedYears = years;\n      const numResearchersPorAnio = years.map(anio =>\n        this.researchers.reduce((total, researcher) => {\n          if (researcher.name === name && researcher.years.includes(anio)) {\n            return total + 1;\n          }\n          return total;\n        }, 0)\n      );\n      return {\n        name: name,\n        years: years,\n        numResearchers: numResearchersPorAnio\n      };\n    });\n  }\n  \n  // Function to save author statistics\n  statsPapersAndArticles() {\n    const names = new Set(this.PapersAndArticles.map(item => item.name));\n    this.ConferencesAndJournalCount = names.size;\n    this.statsPaperAndArticle = Array.from(names).map(name => {\n\n      let years = this.PapersAndArticles.map(item => item.year);\n      years = years.filter((value, index, self) => self.indexOf(value) === index);\n      years.sort((a, b) => parseInt(a) - parseInt(b)); \n      const numPapersAndArticlesPorAnio = years.map(year =>\n        this.PapersAndArticles.reduce((total, item) => {\n          const numPapersAndArticles = item.numPapersAndArticles.low;\n          if (item.name === name && item.year === year) {\n            return total + numPapersAndArticles;\n          }\n          return total;\n        }, 0)\n      );\n      return {\n        name: name,\n        years: years,\n        numResearchers: numPapersAndArticlesPorAnio\n      };\n    });\n\n    this.generateChartPapersAndArticles('lineChart2', this.statsPaperAndArticle);\n\n  }\n\n  // Function to generate and save collaboration statistics\n  statsColaboraciones() {\n    let colabsXtotal: { year: number; numColabs: number; numPapersAndArticles: number }[] = [];\n\n    const colabsPapers = this.PapersAndArticles.map(item => {\n        const colab = this.collaborations.find(c => c.year === item.year);\n        const integer = item.numPapersAndArticles.low;\n        return {\n            year: item.year,\n            numColabs: colab ? colab.numColabs : 0,\n            numPapersAndArticles: integer\n        };\n    });\n    colabsXtotal = colabsXtotal.concat(colabsPapers);\n\n    const densidadesPorAño: { [key: number]: number } = {}; \n    colabsXtotal.forEach(dato => {\n        const { year, numColabs, numPapersAndArticles } = dato;\n        if (!densidadesPorAño[year]) {\n            densidadesPorAño[year] = 0;\n        }\n        densidadesPorAño[year] += numColabs / numPapersAndArticles;\n    });\n\n    const density = Object.entries(densidadesPorAño).map(([year, density]) => ({\n        year: parseInt(year),\n        density\n    }));\n\n    this.statistics[3] = {\n        years: density.map(dato => dato.year),\n        densidades: density.map(dato => dato.density)\n    };\n}\n\n  // Function to generate and save statistics of Single authors\n  statsSingleAuthor() {\n    \n    const papersWithAuthors: { ipName: string, numAuthors: number, authorNames: string[], year: string }[] = [];\n\n    this.singleAuthor.forEach((author: { ipNames: string[], researcher: string, year: string }) => {\n      author.ipNames.forEach(ipName => {\n        const paperIndex = papersWithAuthors.findIndex(paper => paper.ipName === ipName);\n        if (paperIndex !== -1) {\n          papersWithAuthors[paperIndex].numAuthors++;\n          papersWithAuthors[paperIndex].authorNames.push(author.researcher);\n        } else {\n            papersWithAuthors.push({\n              ipName,\n              numAuthors: 1,\n              authorNames: [author.researcher],\n              year: author.year\n            });\n          }\n        });\n    });\n\n    this.papersAndarticlesWithAuthors = papersWithAuthors;\n\n    const papersAndarticlesWithOneAuthor = papersWithAuthors.filter(item => item.numAuthors === 1);\n\n    const porcentajeByYear = this.PapersAndArticles.map(item => {\n      const year = item.year;\n      const numPapersAndArticles = item.numPapersAndArticles.low;\n      const numPapersAndArticlesWithSingleAuthor = papersAndarticlesWithOneAuthor.filter(item => item.year === year).length;\n      const percentage = (numPapersAndArticlesWithSingleAuthor / numPapersAndArticles) * 100;\n    \n      return { year, percentage };\n    });\n\n    this.statistics[4] = {\n      years: porcentajeByYear.map(dato => dato.year),\n      percentages: porcentajeByYear.map(dato => dato.percentage)\n    };\n    \n    let years = this.statistics[4].years;\n    let percentages = this.statistics[4].percentages;\n    \n    let dataByYear:any = {};\n    \n    for (let i = 0; i < years.length; i++) {\n        let year = years[i];\n        let percentage = percentages[i];\n    \n        if (!dataByYear[year]) {\n          dataByYear[year] = [percentage];\n        } else {\n          dataByYear[year].push(percentage);\n        }\n    }\n    \n    let singleYear = [];\n    let AveragePercentages = [];\n    \n    for (let año in dataByYear) {\n        let percentageYear = dataByYear[año];\n        let average = percentageYear.reduce((acc: any, curr: any) => acc + curr, 0) / percentageYear.length;\n        \n        singleYear.push(año);\n        AveragePercentages.push(average);\n    }\n\n    this.statistics[4] = [];\n    \n    this.statistics[4].years = singleYear;\n    this.statistics[4].percentages = AveragePercentages;\n\n    this.singlePapersAndArticle = this.statistics[4];\n    this.generateBarChart('barChart1', 'Single Author Papers and Single Author Journals', this.statistics[4].years, this.statistics[4].percentages);          \n    \n  }  \n\n  // Function to generate and save geographical statistics\n  statsGeography(datasets: any[]){\n    const mappingDate: {[date: string]: {[country: string]: number}} = {};\n    const datasetFiltered = datasets.filter((object: any) => Object.keys(object.frecuencias).length > 0);\n    \n    const uniqueDates = [...new Set(datasetFiltered.map(dato => dato.year))];\n\n    for (const date of uniqueDates) {\n      const objectDate = datasetFiltered.filter(dato => dato.year === date);\n      mappingDate[date] = {};\n  \n    for (const object of objectDate) {\n      let countryHighest = '';\n      let highestFrequency = -1;\n\n      for (const country in object.frecuencias) {\n          if (object.frecuencias[country] > highestFrequency) {\n            countryHighest = country;\n            highestFrequency = object.frecuencias[country];\n          }\n        }\n        if(!(countryHighest in mappingDate[date])){\n          mappingDate[date][countryHighest] = 1;\n        }else{\n          mappingDate[date][countryHighest] = mappingDate[date][countryHighest] + 1;\n        }\n      }\n    }\n\n    for (const year in mappingDate) {\n      let total = 0;\n      for (const country in mappingDate[year]) {\n        total += mappingDate[year][country];\n      }\n      for (const country in mappingDate[year]) {\n        mappingDate[year][country] = Number((mappingDate[year][country]/total).toFixed(4));\n      }\n    }\n\n    const years = Object.keys(mappingDate); \n    const countries = Object.keys(mappingDate[years[0]]); \n    const datasetsLabels = countries; \n\n    const datasetsData = countries.map((country) =>\n      years.map((year) => mappingDate[year][country])\n    );\n\n    this.generateMultipleChart('lineChart5', years, datasetsLabels, datasetsData);\n    \n  }\n\n  // Function to filter authors by decades\n  filterAuthorsByDecade(authors: Author[], startYear: number, endYear: number): Author[] {\n    const filteredAuthors: Author[] = [];\n  \n    authors.forEach((author) => {\n      const authorYears = author.year.split(\",\").map(Number).filter((year) => year >= startYear && year <= endYear);\n\n      if (authorYears.length > 0) {\n     \n        const existingAuthor = filteredAuthors.find((filteredAuthor) => filteredAuthor.researcher === author.researcher);\n        if (existingAuthor) {\n\n          existingAuthor.numPublications += author.numPublications;\n          existingAuthor.year += `, ${author.year}`;\n        } else {\n \n          filteredAuthors.push({\n            ipNames: author.ipNames,\n            numPublications: author.numPublications,\n            researcher: author.researcher,\n            year: author.year\n          });\n        }\n      }\n    });\n\n    return filteredAuthors;\n  }\n\n  // Function to find the most prolific authors of each decade\n  statsProlificAuthors(selectedYears: number[]): DecadeStats[] {\n\n    const startYear = Math.min(...selectedYears);\n    const endYear = Math.max(...selectedYears);\n  \n    const startDecade = Math.floor(startYear / 10) * 10;\n    const endDecade = Math.floor(endYear / 10) * 10;\n  \n    const decades: DecadeStats[] = [];\n    for (let decade = startDecade; decade <= endDecade; decade += 10) {\n      const decadeLabel = `${decade}s`;\n      const decadeStartYear = decade;\n      const decadeEndYear = decade + 9;\n      const decadeAuthors = this.filterAuthorsByDecade(this.singleAuthor, decadeStartYear, decadeEndYear);\n  \n      decades.push({\n        label: decadeLabel,\n        startYear: decadeStartYear,\n        endYear: decadeEndYear,\n        authors: decadeAuthors\n      });\n    }  \n\n    decades.forEach((decade) => {\n      decade.authors.sort((a, b) => b.numPublications - a.numPublications);\n      if (decade.authors.length > 20){\n        decade.authors = decade.authors.slice(0, 20); \n      } \n    });\n  \n    return decades;\n  }\n\n  // Function to generate the Degree table and save the degree of authors\n  statsDegreeAuthors(selectedYears: number[]) {\n    const startYear = Math.min(...selectedYears);\n    const endYear = Math.max(...selectedYears);\n  \n    const allAuthors = this.filterAuthorsByDecade(this.singleAuthor, startYear, endYear);\n    const topAuthors = allAuthors.sort((a, b) => b.numPublications - a.numPublications).slice(0, 20);\n  \n    const tables = {\n      'degree': document.querySelector('#degree tbody'),\n    };\n  \n    for (const author of topAuthors) {\n      const table = tables['degree'];\n  \n      if (table instanceof HTMLElement) {\n        const yearsArray = author.year.split(\",\").map(Number);\n        const minYear = Math.min(...yearsArray);\n        const maxYear = Math.max(...yearsArray);\n\n  \n        const row = document.createElement('tr');\n        row.innerHTML = `\n  \n                         <td >${author.researcher}</td>\n                         <td style=\"padding-left: 50px\" >${author.numPublications}</td>\n                         <td style=\"padding-left: 50px\">${minYear}</td> \n                         <td style=\"padding-left: 80px\">${maxYear}</td>`;\n  \n        table.appendChild(row);\n      }\n    }\n\n  }\n\n  // Function to generate and save gender statistics\n  statsGender(datasets: any[]){\n    const datasetsByGenre: { [genero: string]: { year: string; count: number }[] } = {};\n\n      datasets.forEach((data: { year: any; genero: any; }) => {\n        const { year, genero } = data;\n        \n        let genderKey = '';\n        \n        if (genero == 'M' || genero == '?M' || genero == '1M' || genero == '?') {\n          genderKey = 'Men';\n        } else if (genero == 'F' || genero == '?F' || genero == '1F') {\n          genderKey = 'Women';\n        } else{\n          genderKey = 'Unknown';\n        }\n        \n        if (!datasetsByGenre[genderKey]) {\n          datasetsByGenre[genderKey] = [];\n        }\n        \n        const existingData = datasetsByGenre[genderKey].find(d => d.year === year);\n        \n        if (existingData) {\n          existingData.count++;\n        } else {\n          datasetsByGenre[genderKey].push({\n            year,\n            count: 1\n          });\n        }\n      });\n\n      const sortedData: { [anio: string]: { hombres: number; mujeres: number; total: number} } = {};\n      const men = datasetsByGenre['Men'];\n      const women = datasetsByGenre['Women'];\n\n      men.forEach(dato => {\n        const year = dato.year;\n        const count = dato.count;\n\n        sortedData[year] = { hombres: count, mujeres: 0, total: count };\n      });\n\n      women.forEach(dato => {\n        const year = dato.year;\n        const count = dato.count;\n\n        if (sortedData[year]) {\n          sortedData[year].mujeres = count;\n          sortedData[year].total += count;\n        } else {\n          sortedData[year] = { mujeres: count, hombres: 0, total: count };\n        }\n      });\n\n      const organizedYears = Object.keys(sortedData).sort();\n\n\n      const countMen = organizedYears.map(anio => Number((sortedData[anio].hombres/(sortedData[anio].total)).toFixed(4)));\n      const countWoman = organizedYears.map(anio => Number((sortedData[anio].mujeres/(sortedData[anio].total)).toFixed(4)));\n\n      \n      this.generateCircularChart('lineChart4', organizedYears, ['Hombres', 'Mujeres'], [countMen, countWoman]);\n      this.generateMultipleChart('lineChart8', organizedYears, ['Hombres', 'Mujeres'], [countMen, countWoman]);\n  }\n\n\n  // Function to generate the Decades table\n  generateTablesDecades(decadeStats: any[]){\n    const tables: { [key: string]: HTMLElement | null } = {\n      '1990s': document.querySelector('#table90 tbody'),\n      '2000s': document.querySelector('#table00 tbody'),\n      '2010s': document.querySelector('#table10 tbody'),\n      '2020s': document.querySelector('#table20 tbody'),\n    };\n    for (const decade of decadeStats) {\n      const table = tables[decade.label];\n  \n      if (table instanceof HTMLElement) {\n        decade.authors.slice(0, 20).forEach((autor: { researcher: any; numPublications: any; year: any; }) => {\n          const row = document.createElement('tr');\n          row.innerHTML = `<td>${autor.researcher}</td><td>${autor.numPublications}</td>`;\n  \n          table.appendChild(row);\n        });\n      }\n    }\n  }\n\n  // Function to generate charts of authors\n  generateTotalAuthorsChart(idChart: string, label: string, data: any[]) {\n    const years = data.map(entry => entry.year);\n    const totalAuthors = data.map(entry => entry.totalAuthors);\n    const totalPapers = data.map(entry => entry.totalPapers);\n    const totalArticles = data.map(entry => entry.totalArticles);\n\n    if(idChart == \"lineChart6\"){\n      this.lineChart = new Chart(idChart, {\n        type: 'line',\n        data: {\n          labels: years,\n          datasets: [\n            {\n              label: label,\n              data: totalAuthors,\n              fill: false,\n              borderColor: 'rgb(0, 22, 68)',\n              borderWidth: 1\n            }\n          ]\n        },\n        options: {\n          plugins: {\n            legend: {\n              labels: {\n                color: 'black',\n                font: {\n                  size: 18,\n                  family: 'Roboto',\n                }\n              }\n            }\n          },\n          scales: {\n            y: {\n              type: 'linear',\n              display: true\n            }\n          },\n        }\n      });\n    }\n    \n    if (idChart == \"lineChart7\") {\n      this.lineChart = new Chart(idChart, {\n          type: 'line',\n          data: {\n              labels: years,\n              datasets: [\n                  {\n                      label: 'Papers',\n                      data: totalPapers,\n                      fill: false,\n                      borderColor: \"rgba(51, 153, 255)\",\n                      borderWidth: 1\n                  },\n                  {\n                      label: 'Articles',\n                      data: totalArticles,\n                      fill: false,\n                      borderColor: \"rgba(255, 0, 0, 1)\",\n                      borderWidth: 1\n                  }\n              ]\n          },\n          options: {\n              plugins: {\n                  legend: {\n                      labels: {\n                          color: 'black',\n                          font: {\n                              size: 18,\n                              family: 'Roboto',\n                          }\n                      }\n                  }\n              },\n              scales: {\n                  y: {\n                      type: 'linear',\n                      display: true\n                  }\n              },\n          }\n      });\n    }\n  }\n\n  // Function to generate charts of articles and papers\n  generateChartPapersAndArticles(idChart: string, data: any[]) {\n    const datasets = data.map((entry, index) => ({\n      label: entry.name,\n      data: entry.numResearchers,\n      fill: false,\n      borderColor: this.getRandomColor(index),\n      borderWidth: 1\n    }));\n\n    if(idChart == \"lineChart2\"){\n      this.lineChart = new Chart(idChart, {\n        type: 'line',\n        data: {\n          labels: data[0].years,\n          datasets: datasets\n        },\n        options: {\n          plugins: {\n            legend: {\n              labels: {\n                color: 'black',\n                font: {\n                  size: 18, \n                  family: 'Roboto',\n                }\n              }\n            }\n          },\n          scales: {\n            y: {\n              type: 'linear',\n              display: true\n            }\n          },\n        }\n      });\n    }\n\n    if(idChart == \"lineChart1\"){\n      this.lineChart = new Chart(idChart, {\n        type: 'line',\n        data: {\n          labels: data[0].years,\n          datasets: datasets\n        },\n        options: {\n          plugins: {\n            legend: {\n              labels: {\n                color: 'black',\n                font: {\n                  size: 18, \n                  family: 'Roboto',\n                }\n              }\n            }\n          },\n          scales: {\n            y: {\n              type: 'linear',\n              display: true\n            }\n          },\n        }\n      });\n    }\n  }\n\n  // Function to generate the density chart\n  generateChartDensity(idChart: string, label: string, labels: any[], data: any[]) {\n    this.lineChart = new Chart(idChart, {\n      type: 'line',\n      data: {\n        labels: labels,\n        datasets: [\n          {\n            label: label,\n            data: data,\n            fill: false,\n            borderColor: 'rgb(0, 22, 68)',\n            borderWidth: 1\n          }\n        ]\n      },\n      options: {\n        plugins: {\n          legend: {\n            labels: {\n              color: 'black',\n              font: {\n                size: 18, \n                family: 'Roboto',\n              }\n            }\n          }\n        },\n        scales: {\n          y: {\n            type: 'linear',\n            display: true\n          }\n        },\n      }\n    });\n  }\n\n  //Function to generate a Multiple Chart of Gender\n  generateMultipleChart(chartId: string, labels: string[], datasetsLabels: string[], datasetsData: number[][]) {\n    const datasets = datasetsLabels.map((label, index) => ({\n      label: label,\n      data: datasetsData[index],\n      fill: false,\n      borderColor: this.getRandomColor(index),\n      borderWidth: 1\n    }));\n  \n    const chartConfig: ChartConfiguration<'line'> = {\n      type: 'line',\n      data: {\n        labels: labels,\n        datasets: datasets,\n      },\n      options: {\n        plugins: {\n          legend: {\n            labels: {\n              color: 'black',\n              font: {\n                size: 18, \n                family: 'Roboto',\n              }\n            }\n          }\n        },\n        scales: {\n          y: {\n            type: 'linear',\n            display: true,\n          },\n        },\n      },\n    };\n  \n    const ctx = document.getElementById(chartId) as HTMLCanvasElement;\n    new Chart(ctx, chartConfig);\n  }\n\n  //Function to generate a Circular Chart of Gender\n  generateCircularChart(chartId: string, labels: string[], datasetsLabels: string[], datasetsData: number[][]) {\n    const colors = ['#FF5733', '#3399FF'];\n\n    const datasets = datasetsLabels.map((label, index) => ({\n      label: label,\n      data: datasetsData[index],\n      backgroundColor: colors[index],  \n      borderColor: 'black',\n    }));\n  \n    const chartConfig: ChartConfiguration<'pie'> = {\n      type: 'pie',\n      data: {\n        labels: labels,\n        datasets: datasets,\n      },\n      options: {\n        plugins: {\n          legend: {\n            display: false,\n            labels: {\n              color: 'black',\n              font: {\n                size: 18,\n                family: 'Roboto',\n              }\n            }\n          }\n        },\n      },\n    };\n    const ctx = document.getElementById(chartId) as HTMLCanvasElement;\n    new Chart(ctx, chartConfig);\n  }\n\n  //Function to generate a Chart of SingleAuthors\n  generateBarChart(idChart: string, label: string, labels: any[], data: any[]) {\n    this.barChart = new Chart(idChart, {\n      type: 'bar',\n      data: {\n        labels: labels,\n        datasets: [\n          {\n            label: label,\n            data: data,\n            backgroundColor: 'rgb(0, 22, 68)',\n            borderColor: 'rgb(0, 22, 68)',\n            borderWidth: 1\n          }\n        ]\n      },\n      options: {\n        plugins: {\n          legend: {\n            labels: {\n              color: 'black',\n              font: {\n                size: 18, \n                family: 'Roboto',\n              }\n            }\n          }\n        },\n        scales: {\n          y: {\n            beginAtZero: true\n          }\n        }\n      }\n    });\n  }  \n\n\n  // randomColor(){\n  //   const r = Math.floor(Math.random() * 256);\n  //   const g = Math.floor(Math.random() * 256);\n  //   const b = Math.floor(Math.random() * 256);\n  //   return `rgba(${r}, ${g}, ${b}, 1)`;\n  // }\n\n  // Function to generate a random color\n  getRandomColor(index: number) {\n    let colors: Record<number, string> = {\n      0: \"rgba(51, 153, 255)\",\n      1: \"rgba(255, 0, 0, 1)\",\n      2: \"rgba(98, 192, 75, 1)\", \n      3: \"rbga(192, 141, 75, 1)\",\n      4: \"rgba(226, 232, 107, 1)\",\n      5: \"rgba(176, 75, 192, 1)\",\n      6: \"rgba(255, 153, 51, 1)\", // Naranja brillante\n      7: \"rgba(102, 204, 204, 1)\", // Verde azulado\n      8: \"rgba(255, 102, 204, 1)\", // Rosa brillante\n      9: \"rgba(153, 102, 204, 1)\", // Morado azulado\n      10: \"rgba(255, 204, 102, 1)\" // Amarillo suave\n    };\n\n    return colors[index];\n  }\n\n  // Function to load the file with the list of names \n  loadCommonNames() {\n    this.http.get('assets/common_names.txt', { responseType: 'text' }).subscribe(\n      (data: string) => {\n        this.commonNames = this.parseCommonNames(data);\n      },\n      (error: any) => {\n        console.error('Error al cargar los datos:', error);\n      }\n    );\n  }\n\n  // Function to analyze common names\n  parseCommonNames(data: string) {\n\n    const lines = data.split('\\n');\n    const dict: { [key: string]: { frec_paises: { [key: string]: number }, genero: string } } = {};\n    let currentName = '';\n    let currentData: { frec_paises: { [key: string]: number }, genero: string } = {\n      frec_paises: {},\n      genero: ''\n    };\n  \n    for (const linea of lines) {\n      if (linea.startsWith('nombre:')) {\n        currentName = linea.split(':')[1].trim();\n        currentData = { frec_paises: {}, genero: '' };\n      } else if (linea.startsWith('frec_paises:')) {\n        const frec_paisesStr = linea.substring(linea.indexOf('{'), linea.lastIndexOf('}') + 1);\n        const frec_paises = JSON.parse(frec_paisesStr);\n        currentData.frec_paises = frec_paises;\n      } else if (linea.startsWith('genero:')) {\n        currentData.genero = linea.split(':')[1].trim();\n      } else if (linea.trim() === '') {\n        dict[currentName] = currentData;\n      }\n    }\n    return dict;\n  }\n\n  // Async functions to wait for data\n\n  async waitResearcherNoEmpty() {\n    while (!this.researchers || this.researchers.length === 0) {\n      await new Promise(resolve => setTimeout(resolve, 100)); \n    }\n  }\n\n  async waitPapersAndArticlesNoEmpty() {\n    while (!this.PapersAndArticles || this.PapersAndArticles.length === 0) {\n      await new Promise(resolve => setTimeout(resolve, 100)); \n    }\n  }\n\n  async waitAuthorsWithPapersAndArticlesNoEmpty(){\n    while (!this.papersAndarticlesWithAuthors || this.papersAndarticlesWithAuthors.length === 0) {\n      await new Promise(resolve => setTimeout(resolve, 100)); \n    }\n  }\n\n  async waitSingleAuthorsNoEmpty(){\n    while (!this.singleAuthor || this.singleAuthor.length === 0) {\n      await new Promise(resolve => setTimeout(resolve, 100)); \n    }\n  }\n\n  async main(){\n    try {\n\n      if(this.stadisticsService.ConferenceOrJournalConfirm != this.stadisticsService.getConferenceOrJournalName()){\n        this.getConferencebyProceeding();\n      }else{\n        this.generateTablesProceeding(this.stadisticsService.ConferenceOrJournalNames, this.stadisticsService.years, this.stadisticsService.inprocedings);\n      }\n      this.getResearchersConferenceAndJournals();\n      this.getPapersAndArticles();\n      this.getConferencebyProceeding();\n  \n      if(this.researchers.length == 0){\n        await this.waitResearcherNoEmpty(); \n        this.getDemographicData();\n      } else{\n        this.getDemographicData();\n      }\n\n      if(this.PapersAndArticles.length == 0){\n        await this.waitPapersAndArticlesNoEmpty();\n        this.getCollaborations();\n        this.getAuthorsPapersAndArticles();\n      }else{\n         this.getCollaborations();;\n         this.getAuthorsPapersAndArticles();\n      }\n\n      while(this.collaborations.length < 1){\n        this.loadingTable2 = true;\n        await new Promise(resolve => setTimeout(resolve, 1000));\n        this.spinnerService.show();\n      }\n      this.loadingTable2 = false;\n\n      if(this.papersAndarticlesWithAuthors.length == 0){\n        await this.waitAuthorsWithPapersAndArticlesNoEmpty();\n        this.getTopicAnalysis();\n        this.getDistributions();\n      }else{\n        this.getTopicAnalysis();\n        this.getDistributions();\n      }\n\n\n      \n      if(this.singleAuthor.length == 0){\n        await this.waitSingleAuthorsNoEmpty();\n        this.decadeStats = this.statsProlificAuthors(this.selectedYears);\n        this.generateTablesDecades(this.decadeStats)\n      }else{\n        this.decadeStats = this.statsProlificAuthors(this.selectedYears);\n        this.generateTablesDecades(this.decadeStats)\n      }\n      this.statsDegreeAuthors(this.selectedYears);\n \n      while(this.stadisticsService.ConferenceOrJournalNames.length <1){\n        this.loadingTable1 = true;\n        await new Promise(resolve => setTimeout(resolve, 100));\n        this.spinnerService.show()\n      }\n      this.loadingTable1 = false;\n      this.stadisticsService.ConferenceOrJournalConfirm = this.stadisticsService.getConferenceOrJournalName();\n\n     \n  } catch (error) {\n    console.error('Error in getData with:', error);\n  }\n  }\n\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}