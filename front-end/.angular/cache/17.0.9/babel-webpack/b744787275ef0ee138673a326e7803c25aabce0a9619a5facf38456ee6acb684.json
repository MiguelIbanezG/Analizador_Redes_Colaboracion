{"ast":null,"code":"import { DataSet } from 'vis';\nimport * as i0 from \"@angular/core\";\nexport class AppNetworkInitService {\n  constructor() {\n    this.nameAuthors = [];\n    this.selectedAuthors = [];\n  }\n  getNodes() {\n    this.nameAuthors = this.nameAuthors.map(author => {\n      let researcher = author.researcher;\n      researcher = researcher.replace(/&aacute;/g, 'á').replace(/&eacute;/g, 'é').replace(/&iacute;/g, 'í').replace(/&oacute;/g, 'ó').replace(/&uacute;/g, 'ú').replace(/&ntilde;/g, 'ñ').replace(/&Aacute;/g, 'Á').replace(/&Eacute;/g, 'É').replace(/&Iacute;/g, 'Í').replace(/&Oacute;/g, 'Ó').replace(/&Uacute;/g, 'Ú').replace(/&Ntilde;/g, 'Ñ').replace(/&agrave;/g, 'à').replace(/&egrave;/g, 'è').replace(/&ograve;/g, 'ò').replace(/&Agrave;/g, 'À').replace(/&Egrave;/g, 'È').replace(/&Ograve;/g, 'Ò').replace(/&acirc;/g, 'â').replace(/&Acirc;/g, 'Â').replace(/&atilde;/g, 'ã').replace(/&Atilde;/g, 'Ã').replace(/&ouml;/g, 'ö').replace(/&Ouml;/g, 'Ö');\n      author.researcher = researcher;\n      return author;\n    });\n    const authorWithMostPublications = this.nameAuthors.reduce((prevAuthor, currentAuthor) => {\n      if (currentAuthor.researcher !== this.selectedAuthors[0]) {\n        if (!prevAuthor || currentAuthor.publications.length > prevAuthor.publications.length) {\n          return currentAuthor;\n        }\n      }\n      return prevAuthor;\n    }, null);\n    const authorWithLeastPublications = this.nameAuthors.reduce((prevAuthor, currentAuthor) => {\n      return prevAuthor.publications.length < currentAuthor.publications.length ? prevAuthor : currentAuthor;\n    });\n    const maxPublications = authorWithMostPublications.publications.length;\n    const minPublications = authorWithLeastPublications.publications.length;\n    const distances = {};\n    this.nameAuthors.forEach(author => {\n      if (author.researcher !== this.selectedAuthors[0]) {\n        const proportion = (maxPublications - author.publications.length) / (maxPublications - minPublications);\n        const distance = proportion * (300 - 40) + 40; // Distancia proporcional entre 20 y 300\n        distances[author.researcher] = distance;\n      }\n    });\n    console.log(distances);\n    const nodesData = this.nameAuthors.map(author => {\n      let nodeSize = Math.floor(author.publications.length * 3) + 30;\n      if (author.researcher === this.selectedAuthors[0]) {\n        nodeSize = 100;\n      }\n      var distanceFromCenter = 0;\n      if (this.selectedAuthors[0] != author.researcher) {\n        var distanceFromCenter = distances[author.researcher] * 5;\n      }\n      var x = 0;\n      var y = 0;\n      // Agrupar autores por cantidad de publicaciones\n      const authorsByPublications = {};\n      this.nameAuthors.forEach(author => {\n        const numPublications = author.publications.length;\n        if (!authorsByPublications[numPublications]) {\n          authorsByPublications[numPublications] = [];\n        }\n        authorsByPublications[numPublications].push(author);\n      });\n      // Calcular ángulos para cada grupo de autores\n      let angleOffset = 0;\n      Object.values(authorsByPublications).forEach(authorsGroup => {\n        const groupAngle = Math.PI * 2 / authorsGroup.length;\n        authorsGroup.forEach((author, index) => {\n          const distanceFromCenter = distances[author.researcher] * 5;\n          const angle = angleOffset + groupAngle * index;\n          x = Math.cos(angle) * distanceFromCenter;\n          y = Math.sin(angle) * distanceFromCenter;\n          // Aquí puedes usar las coordenadas (x, y) para posicionar el nodo\n          console.log(author.researcher, x, y);\n        });\n        angleOffset += groupAngle; // Incrementar el offset para el siguiente grupo\n      });\n\n      return {\n        id: author.researcher,\n        label: author.researcher,\n        font: {\n          size: nodeSize,\n          color: \"#ffffff\"\n        },\n        x: x,\n        y: y\n      };\n    });\n    const nodes = new DataSet(nodesData);\n    return nodes;\n  }\n  getEdges() {\n    const edgesData = this.nameAuthors.filter(author => author.researcher !== this.selectedAuthors[0]).map(author => {\n      const numPublications = author.publications.length.toString();\n      return {\n        from: this.selectedAuthors[0],\n        to: author.researcher,\n        label: numPublications\n      };\n    });\n    const edges = new DataSet(edgesData);\n    return edges;\n  }\n  static #_ = this.ɵfac = function AppNetworkInitService_Factory(t) {\n    return new (t || AppNetworkInitService)();\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: AppNetworkInitService,\n    factory: AppNetworkInitService.ɵfac\n  });\n}","map":{"version":3,"names":["DataSet","AppNetworkInitService","constructor","nameAuthors","selectedAuthors","getNodes","map","author","researcher","replace","authorWithMostPublications","reduce","prevAuthor","currentAuthor","publications","length","authorWithLeastPublications","maxPublications","minPublications","distances","forEach","proportion","distance","console","log","nodesData","nodeSize","Math","floor","distanceFromCenter","x","y","authorsByPublications","numPublications","push","angleOffset","Object","values","authorsGroup","groupAngle","PI","index","angle","cos","sin","id","label","font","size","color","nodes","getEdges","edgesData","filter","toString","from","to","edges","_","_2","factory","ɵfac"],"sources":["/home/miguel/Analizador_Redes_Colaboracion/interfaz/src/app/services/network.init.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { Network, DataSet, Options, Data, IdType, Edge } from 'vis';\nimport { Node } from '../models/network.model';\nimport { auth } from 'neo4j-driver';\n@Injectable()\nexport class AppNetworkInitService {\n\n  public nameAuthors:any = [];\n  public selectedAuthors:any = [];\n\n  getNodes(): DataSet<Node> {\n    \n    this.nameAuthors = this.nameAuthors.map((author: any) => {\n      let researcher = author.researcher; \n  \n      researcher = researcher.replace(/&aacute;/g, 'á')\n          .replace(/&eacute;/g, 'é')\n          .replace(/&iacute;/g, 'í')\n          .replace(/&oacute;/g, 'ó')\n          .replace(/&uacute;/g, 'ú')\n          .replace(/&ntilde;/g, 'ñ')\n          .replace(/&Aacute;/g, 'Á')\n          .replace(/&Eacute;/g, 'É')\n          .replace(/&Iacute;/g, 'Í')\n          .replace(/&Oacute;/g, 'Ó')\n          .replace(/&Uacute;/g, 'Ú')\n          .replace(/&Ntilde;/g, 'Ñ')\n          .replace(/&agrave;/g, 'à')\n          .replace(/&egrave;/g, 'è')\n          .replace(/&ograve;/g, 'ò')\n          .replace(/&Agrave;/g, 'À')\n          .replace(/&Egrave;/g, 'È')\n          .replace(/&Ograve;/g, 'Ò')\n          .replace(/&acirc;/g, 'â')\n          .replace(/&Acirc;/g, 'Â')\n          .replace(/&atilde;/g, 'ã')\n          .replace(/&Atilde;/g, 'Ã')\n          .replace(/&ouml;/g, 'ö')\n          .replace(/&Ouml;/g, 'Ö');\n  \n      author.researcher = researcher;\n  \n      return author;\n  });\n\n      const authorWithMostPublications = this.nameAuthors.reduce((prevAuthor: any, currentAuthor: any) => {\n        if (currentAuthor.researcher !== this.selectedAuthors[0]) {\n            if (!prevAuthor || currentAuthor.publications.length > prevAuthor.publications.length) {\n                return currentAuthor;\n            }\n        }\n        return prevAuthor;\n    }, null);\n\n    const authorWithLeastPublications = this.nameAuthors.reduce((prevAuthor: { publications: string | any[]; }, currentAuthor: { publications: string | any[]; }) => {\n      return (prevAuthor.publications.length < currentAuthor.publications.length) ? prevAuthor : currentAuthor;\n    });\n\n    const maxPublications = authorWithMostPublications.publications.length;\n    const minPublications = authorWithLeastPublications.publications.length;\n\n    const distances: { [key: string]: number } = {};\n    this.nameAuthors.forEach((author: any) => {\n        if (author.researcher !== this.selectedAuthors[0]) {\n            const proportion = (maxPublications - author.publications.length) / (maxPublications - minPublications);\n            const distance = proportion * (300 - 40) + 40; // Distancia proporcional entre 20 y 300\n            distances[author.researcher] = distance;\n        }\n    });\n\n    console.log(distances)\n\n    const nodesData: Node[] = this.nameAuthors.map((author: any) => {\n      let nodeSize = Math.floor(author.publications.length * 3) + 30;\n      if (author.researcher === this.selectedAuthors[0]) {\n          nodeSize = 100; \n      }\n\n      var distanceFromCenter = 0;\n\n      if(this.selectedAuthors[0] != author.researcher){\n        var distanceFromCenter = distances[author.researcher] * 5\n      }\n\n      var x = 0;\n      var y = 0;\n\n\n    // Agrupar autores por cantidad de publicaciones\n    const authorsByPublications:any = {};\n    this.nameAuthors.forEach((author: any) => {\n        const numPublications = author.publications.length;\n        if (!authorsByPublications[numPublications]) {\n            authorsByPublications[numPublications] = [];\n        }\n        authorsByPublications[numPublications].push(author);\n    });\n\n    // Calcular ángulos para cada grupo de autores\n    let angleOffset = 0;\n    Object.values(authorsByPublications).forEach((authorsGroup:any) => {\n        const groupAngle = Math.PI * 2 / authorsGroup.length;\n        authorsGroup.forEach((author:any, index:any) => {\n            const distanceFromCenter = distances[author.researcher] * 5;\n            const angle = angleOffset + groupAngle * index;\n             x = Math.cos(angle) * distanceFromCenter;\n             y = Math.sin(angle) * distanceFromCenter;\n            // Aquí puedes usar las coordenadas (x, y) para posicionar el nodo\n            console.log(author.researcher, x, y);\n        });\n        angleOffset += groupAngle; // Incrementar el offset para el siguiente grupo\n    });\n\n      return {\n        id: author.researcher,\n        label: author.researcher,\n        font: {\n          size: nodeSize,\n          color: \"#ffffff\"\n        },\n        x: x,\n        y: y\n      };\n    });\n\n    const nodes: DataSet<Node> = new DataSet(nodesData);\n    return nodes;\n  }\n\n\n  getEdges(): DataSet<Edge> {\n\n    const edgesData: Edge[] = this.nameAuthors\n    .filter((author: { researcher: any; }) => author.researcher !== this.selectedAuthors[0])\n    .map((author: { publications: string | any[]; researcher: any; }) => {\n      const numPublications = author.publications.length.toString();\n      return { from: this.selectedAuthors[0], to: author.researcher, label: numPublications };\n    });\n\n    const edges: DataSet<Edge> = new DataSet(edgesData);\n    return edges;\n}\n  \n\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}